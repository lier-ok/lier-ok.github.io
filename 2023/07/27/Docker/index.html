

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/cute_icon.png">
  <link rel="icon" href="/img/cute_icon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="lier">
  <meta name="keywords" content="">
  
  <title>Docker - Blog</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.4.0/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.9","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}}};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>lier的博客</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/background.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="Docker">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2023-07-27 11:02" pubdate>
        2023年7月27日 上午
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      6.7k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      103
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Docker</h1>
            
            <div class="markdown-body">
              <h1 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h1><h4 id="1-docker入门"><a href="#1-docker入门" class="headerlink" title="1:docker入门"></a>1:docker入门</h4><h5 id="1-1-虚拟化和容器化技术对比"><a href="#1-1-虚拟化和容器化技术对比" class="headerlink" title="1.1 虚拟化和容器化技术对比"></a>1.1 虚拟化和容器化技术对比</h5><p> 虚拟化技术的缺点:资源占用十分多,冗余步骤多,启动很慢</p>
<h5 id="1-2-比较Docker和虚拟化技术的不同"><a href="#1-2-比较Docker和虚拟化技术的不同" class="headerlink" title="1.2 比较Docker和虚拟化技术的不同"></a>1.2 比较Docker和虚拟化技术的不同</h5><p> 传统虚拟机， 虚拟出一条硬件，运行一个完整的操作系统，然后在这个系统上安装和运行软件<br>​ 容器内的应用直接运行在宿主机的内部，容器是没有自己的内核的，也没有虚拟硬件，所以轻便<br>​ 每个容器间是相互隔离的，每个容器内都有一个属于自己的文件系统，互不影响<br>​ 应用更快速的交互和部署</p>
<p> 传统：一堆帮助文档，安装程序<br>​ Docker： 打包镜像发布测试，一键运行<br>​ 更便捷的升级和扩缩容<br>​ 更简的系统运维<br>​ 更高效的计算资源利用</p>
<h5 id="1-3-基本底层原理"><a href="#1-3-基本底层原理" class="headerlink" title="1.3 基本底层原理"></a>1.3 基本底层原理</h5><p>底层原理</p>
<p> Docker Engine是一个客户端-服务器应用程序，具有以下主要组件:</p>
<p> 一个服务器，它是一种长期运行的程序，称为守护进程(dockerd命令)<br>​ 一个REST API，它指定程序可以用来与守护进程对话并指示它做什么的接口。<br>​ Docker是一个Client Server结构的系统，Docker守护进程运行在主机上，然后通过Socket连接从客户 端访问，守护进程从客户端接受 命令并管理运行在主机上的容器。</p>
<h5 id="1-4-相关名词"><a href="#1-4-相关名词" class="headerlink" title="1.4 相关名词"></a>1.4 相关名词</h5><p>①镜像（image）</p>
<p> Docker镜像就好比是一个模板，可以通过这个模板来创建容器服务，tomcat镜像 &#x3D;&#x3D;&#x3D;&gt; run &#x3D;&#x3D;&#x3D;&gt; tomcat01容器， 通过这个镜像可以 创建多个容器（最终服务运行或者项目运行就是在容器中的）</p>
<p>②容器（container）<br>Docker利用容器技术，独立运行一个或者一组应用， 通过镜像来创建的<br>启动，停止，删除，基本命令！<br>就目前可以把这个容器理解为一个建议的linux系统</p>
<p>③仓库（repository）<br>存放镜像的地方<br>Docker Hub（默认是国外的）<br>阿里云,,,都有容器服务（配置镜像加速！）</p>
<h4 id="2-docker常用命令"><a href="#2-docker常用命令" class="headerlink" title="2 docker常用命令"></a>2 docker常用命令</h4><h5 id="2-1-帮助命令"><a href="#2-1-帮助命令" class="headerlink" title="2.1 :帮助命令"></a>2.1 :帮助命令</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs SHELL">docker version  # docker版本信息<br>docker info     # 系统级别的信息，包括镜像和容器的数量<br>docker 命令 --help <br><br><br></code></pre></td></tr></table></figure>

<h5 id="2-2-镜像命令"><a href="#2-2-镜像命令" class="headerlink" title="2.2 :镜像命令"></a>2.2 :镜像命令</h5><h6 id="2-2-1-docker-images-查看所有本地主机上的镜像"><a href="#2-2-1-docker-images-查看所有本地主机上的镜像" class="headerlink" title="2.2.1 docker images 查看所有本地主机上的镜像"></a>2.2.1 docker images 查看所有本地主机上的镜像</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs SHELL">[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker images<br>REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE<br>hello-world         latest              bf756fb1ae65        7 months ago        13.3kB<br><span class="hljs-meta prompt_"> </span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">解释</span><br>REPOSITORY      # 镜像的仓库<br>TAG             # 镜像的标签<br>IMAGE ID        # 镜像的ID<br>CREATED         # 镜像的创建时间<br>SIZE            # 镜像的大小<br><span class="hljs-meta prompt_"> </span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">可选项</span><br>--all , -a      # 列出所有镜像<br>--quiet , -q    # 只显示镜像的id<br><br><br></code></pre></td></tr></table></figure>

<h6 id="2-2-2-docker-search-查找镜像"><a href="#2-2-2-docker-search-查找镜像" class="headerlink" title="2.2.2 docker search 查找镜像"></a>2.2.2 docker search 查找镜像</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs SHELL"><span class="hljs-meta prompt_"># </span><span class="language-bash">可选项</span><br>--filter=STARS=3000     # 搜素出来的镜像就是STARS大于3000的<br>docker search mysql --filter=STARS=3000 #查询收藏大于3000的镜像<br><br><br></code></pre></td></tr></table></figure>

<h6 id="2-2-3-docker-pull-下拉镜像"><a href="#2-2-3-docker-pull-下拉镜像" class="headerlink" title="2.2.3 docker pull 下拉镜像"></a>2.2.3 docker pull 下拉镜像</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs SHELL"><span class="hljs-meta prompt_"># </span><span class="language-bash">下载镜像，docker pull 镜像名[:tag] tag必须在官网支持版本中</span><br>[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker pull mysql<br>Using default tag: latest           # 如果不写tag，默认就是latest<br>latest: Pulling from library/mysql<br>bf5952930446: Pull complete         # 分层下载，docker images的核心，联合文件系统<br>8254623a9871: Pull complete <br>938e3e06dac4: Pull complete <br>ea28ebf28884: Pull complete <br>f3cef38785c2: Pull complete <br>894f9792565a: Pull complete <br>1d8a57523420: Pull complete <br>6c676912929f: Pull complete <br>ff39fdb566b4: Pull complete <br>fff872988aba: Pull complete <br>4d34e365ae68: Pull complete <br>7886ee20621e: Pull complete <br>Digest: sha256:c358e72e100ab493a0304bda35e6f239db2ec8c9bb836d8a427ac34307d074ed     # 签名<br>Status: Downloaded newer image for mysql:latest<br>docker.io/library/mysql:latest      # 真实地址<br><span class="hljs-meta prompt_"> </span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">等价于</span><br>docker pull mysql<br>docker pull docker.io/library/mysql:latest<br><span class="hljs-meta prompt_"> </span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">指定版本下载</span><br>[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker pull mysql:5.7<br>5.7: Pulling from library/mysql<br>bf5952930446: Already exists   #已经在上面下载过了,无需下载----&gt; 分层下载<br>8254623a9871: Already exists <br>938e3e06dac4: Already exists <br>ea28ebf28884: Already exists <br>f3cef38785c2: Already exists <br>894f9792565a: Already exists <br>1d8a57523420: Already exists <br>5f09bf1d31c1: Pull complete <br>1b6ff254abe7: Pull complete <br>74310a0bf42d: Pull complete <br>d398726627fd: Pull complete <br>Digest: sha256:da58f943b94721d46e87d5de208dc07302a8b13e638cd1d24285d222376d6d84<br>Status: Downloaded newer image for mysql:5.7<br>docker.io/library/mysql:5.7  #镜像真实地址<br><br><br></code></pre></td></tr></table></figure>

<h6 id="2-2-4-docker-rmi-删除镜像"><a href="#2-2-4-docker-rmi-删除镜像" class="headerlink" title="2.2.4 docker rmi 删除镜像"></a>2.2.4 docker rmi 删除镜像</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker rmi -f IMAGE ID                        # 删除指定镜像<br>[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker rmi -f IMAGE ID1 IMAGE ID2 IMAGE ID3   # 删除多个镜像<br>[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker rmi -f $(docker images -aq)            # 删除所有镜像<br><br><br></code></pre></td></tr></table></figure>

<h5 id="2-3-容器命令"><a href="#2-3-容器命令" class="headerlink" title="2.3 容器命令"></a>2.3 容器命令</h5><h6 id="2-3-1-新建容器并启动"><a href="#2-3-1-新建容器并启动" class="headerlink" title="2.3.1 新建容器并启动"></a>2.3.1 新建容器并启动</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs SHELL">docker run [可选参数] image<br><span class="hljs-meta prompt_"> </span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">参数说明</span><br>--name=“Name”   容器名字    tomcat01    tomcat02    用来区分容器<br>-d      后台方式运行<br>-it     使用交互方式运行，进入容器查看内容<br>-p      指定容器的端口     -p 8080:8080<br>    -p  ip:主机端口：容器端口<br>    -p  主机端口：容器端口（常用）<br>    -p  容器端口<br>    容器端口<br>-p      随机指定端口<br> <br><span class="hljs-meta prompt_"> </span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">测试，启动并进入容器</span><br>[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker run -it centos /bin/bash<br>[root@74e82b7980e7 /]# ls   # 查看容器内的centos，基础版本，很多命令是不完善的<br>bin  etc   lib    lost+found  mnt  proc  run   srv  tmp  var<br>dev  home  lib64  media       opt  root  sbin  sys  usr<br><span class="hljs-meta prompt_"> </span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">从容器中退回主机</span><br>[root@77969f5dcbf9 /]# exit<br>exit<br>[root@iZ2zeg4ytp0whqtmxbsqiiZ /]# ls<br>bin   dev  fanfan  lib    lost+found  mnt  proc  run   srv  tmp  var<br>boot  etc  home    lib64  media       opt  root  sbin  sys  usr<br><br><br></code></pre></td></tr></table></figure>

<h6 id="2-3-2-列出所有的运行的容器"><a href="#2-3-2-列出所有的运行的容器" class="headerlink" title="2.3.2 列出所有的运行的容器"></a>2.3.2 列出所有的运行的容器</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs SHELL"><span class="hljs-meta prompt_"># </span><span class="language-bash">docker ps 命令</span><br>        # 列出当前正在运行的容器<br>-a      # 列出正在运行的容器包括历史容器<br>-n=?    # 显示最近创建的容器 ?为数字,表示近几个<br>-q      # 只显示当前容器的编号<br> <br>[root@iZ2zeg4ytp0whqtmxbsqiiZ /]# docker ps<br>CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES<br>[root@iZ2zeg4ytp0whqtmxbsqiiZ /]# docker ps -a<br>CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS                     PORTS               NAMES<br>77969f5dcbf9        centos              &quot;/bin/bash&quot;         5 minutes ago       Exited (0) 5 minutes ago                       xenodochial_bose<br>74e82b7980e7        centos              &quot;/bin/bash&quot;         16 minutes ago      Exited (0) 6 minutes ago                       silly_cori<br>a57250395804        bf756fb1ae65        &quot;/hello&quot;            7 hours ago         Exited (0) 7 hours ago                         elated_nash<br>392d674f4f18        bf756fb1ae65        &quot;/hello&quot;            8 hours ago         Exited (0) 8 hours ago                         distracted_mcnulty<br>571d1bc0e8e8        bf756fb1ae65        &quot;/hello&quot;            23 hours ago        Exited (0) 23 hours ago                        magical_burnell<br> <br>[root@iZ2zeg4ytp0whqtmxbsqiiZ /]# docker ps -qa<br>77969f5dcbf9<br>74e82b7980e7<br>a57250395804<br>392d674f4f18<br>571d1bc0e8e8<br><br><br></code></pre></td></tr></table></figure>

<h6 id="2-3-3-退出容器"><a href="#2-3-3-退出容器" class="headerlink" title="2.3.3 退出容器"></a>2.3.3 退出容器</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs SHELL">exit            # 直接退出容器并关闭<br>Ctrl + P + Q    # 容器不关闭退出<br><br><br></code></pre></td></tr></table></figure>

<h6 id="2-3-4-删除容器"><a href="#2-3-4-删除容器" class="headerlink" title="2.3.4 删除容器"></a>2.3.4 删除容器</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs SHELL">docker rm -f 容器id                       # 删除指定容器<br>docker rm -f $(docker ps -aq)       # 删除所有容器<br>docker ps -a -q|xargs docker rm -f  # 删除所有的容器<br><br><br></code></pre></td></tr></table></figure>

<h6 id="2-3-5-启动和停止容器的操作"><a href="#2-3-5-启动和停止容器的操作" class="headerlink" title="2.3.5 启动和停止容器的操作"></a>2.3.5 启动和停止容器的操作</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs SHELL">docker start 容器id           # 启动容器<br>docker restart 容器id         # 重启容器<br>docker stop 容器id            # 停止当前正在运行的容器<br>docker kill 容器id            # 强制停止当前的容器<br><br><br></code></pre></td></tr></table></figure>

<h4 id="2-4-其他常用命令"><a href="#2-4-其他常用命令" class="headerlink" title="2.4 其他常用命令"></a>2.4 其他常用命令</h4><h6 id="2-4-1-注意点"><a href="#2-4-1-注意点" class="headerlink" title="2.4.1 注意点"></a>2.4.1 注意点</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs SHELL"><span class="hljs-meta prompt_"># </span><span class="language-bash">命令 docker run -d 镜像名</span><br>[root@iZ2zeg4ytp0whqtmxbsqiiZ /]# docker run -d centos<br><span class="hljs-meta prompt_"> </span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">问题 docker ps， 发现centos停止了</span><br><span class="hljs-meta prompt_"> </span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">常见的坑， docker 容器使用后台运行， 就必须要有一个前台进程，docker发现没有应用，就会自动停止</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">nginx， 容器启动后，发现自己没有提供服务，就会立即停止，就是没有程序了</span><br><br><br></code></pre></td></tr></table></figure>

<h6 id="2-4-2-查看日志"><a href="#2-4-2-查看日志" class="headerlink" title="2.4.2 查看日志"></a>2.4.2 查看日志</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs SHELL"><span class="hljs-meta prompt_">#</span><span class="language-bash">后台运行容器并写入运行shell脚本</span><br>[root@hadoop1 ~]# docker run -d centos /bin/sh &quot;while true;do echo test;sleep 1;done&quot;<br>949b9679a8907627a95171b99482abed59714a4d5a21354c52ad8708578a07dd<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">查询正在运行的容器</span><br>[root@hadoop1 ~]# docker ps<br>CONTAINER ID   IMAGE     COMMAND                  CREATED          STATUS          PORTS     NAMES<br>44a6d67584d6   centos    &quot;/bin/sh -c &#x27;while t…&quot;   19 seconds ago   Up 18 seconds             awesome_cori<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">查看对应容器日志</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">-tf 查看全部日志</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">--<span class="hljs-built_in">tail</span> number 查看指定number条日志</span><br>[root@hadoop1 ~]# docker logs -tf 44a6d67584d6<br>2021-11-01T10:09:16.277847024Z test<br>2021-11-01T10:09:17.284248062Z test<br>2021-11-01T10:09:18.288563750Z test<br>2021-11-01T10:09:19.295090565Z test<br>2021-11-01T10:09:20.298176959Z test<br>2021-11-01T10:09:21.303277365Z test<br><br><br><br></code></pre></td></tr></table></figure>

<h6 id="2-4-3-查看容器中进程信息"><a href="#2-4-3-查看容器中进程信息" class="headerlink" title="2.4.3 查看容器中进程信息"></a>2.4.3 查看容器中进程信息</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs SHELL">[root@hadoop1 ~]# docker top 44a6d67584d6(容器id)<br>UID                 PID                 PPID                C                   STIME               TTY     <br>root                17445               17425               0                   18:09               ?        root                17846               17445               0                   18:13               ?       <br><br><br></code></pre></td></tr></table></figure>

<h6 id="2-4-4-查看镜像的元数据"><a href="#2-4-4-查看镜像的元数据" class="headerlink" title="2.4.4 查看镜像的元数据"></a>2.4.4 查看镜像的元数据</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs SHELL">[root@hadoop1 ~]# docker inspect 44a6d67584d6<br>[<br>    &#123;<br>        &quot;Id&quot;: &quot;44a6d67584d6d8eb9f2533971853e47094ff1dd85ae8a112e4474860f28f6dc8&quot;,<br>        &quot;Created&quot;: &quot;2021-11-01T10:09:15.27493519Z&quot;,<br>        &quot;Path&quot;: &quot;/bin/sh&quot;,<br>        &quot;Args&quot;: [<br>            &quot;-c&quot;,<br>            &quot;while true;do echo test;sleep 1;done&quot;<br>        ],<br>        &quot;State&quot;: &#123;<br>            &quot;Status&quot;: &quot;running&quot;,<br>            &quot;Running&quot;: true,<br>            &quot;Paused&quot;: false,<br>            &quot;Restarting&quot;: false,<br>            &quot;OOMKilled&quot;: false,<br>            &quot;Dead&quot;: false,<br>            &quot;Pid&quot;: 17445,<br>            &quot;ExitCode&quot;: 0,<br>            &quot;Error&quot;: &quot;&quot;,<br>            &quot;StartedAt&quot;: &quot;2021-11-01T10:09:16.278907345Z&quot;,<br>            &quot;FinishedAt&quot;: &quot;0001-01-01T00:00:00Z&quot;<br>        &#125;,<br>  ......等<br><br><br><br></code></pre></td></tr></table></figure>

<h6 id="2-4-5-进入当前正在运行的容器"><a href="#2-4-5-进入当前正在运行的容器" class="headerlink" title="2.4.5 进入当前正在运行的容器"></a>2.4.5 <strong>进入当前正在运行的容器</strong></h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs SHELL">[root@hadoop1 ~]# docker exec -it 44a6d67584d6 /bin/bash<br>[root@44a6d67584d6 /]# ls<br>bin  dev  etc  home  lib  lib64  lost+found  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var<br><br>[root@hadoop1 ~]# docker attach 44a6d67584d6<br>test<br>test<br>test<br><br><br><br><br></code></pre></td></tr></table></figure>

<h6 id="2-4-6-从容器中拷贝文件到主机"><a href="#2-4-6-从容器中拷贝文件到主机" class="headerlink" title="2.4.6 从容器中拷贝文件到主机"></a>2.4.6 <strong>从容器中拷贝文件到主机</strong></h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs SHELL"><span class="hljs-meta prompt_">#</span><span class="language-bash">先创建</span><br>[root@7967f3648636 home]# touch test.java<br>[root@7967f3648636 home]# ls<br>test.java<br><br>docker cp 容器id：容器内路径    目的地主机路径<br> <br>[root@iZ2zeg4ytp0whqtmxbsqiiZ /]# docker cp 7af535f807e0:/home/test.java /home<br><br><br></code></pre></td></tr></table></figure>

<h3 id="3-配置Nginx-和-Tomcat"><a href="#3-配置Nginx-和-Tomcat" class="headerlink" title="3 配置Nginx 和 Tomcat"></a>3 配置Nginx 和 Tomcat</h3><h5 id="3-1-nginx"><a href="#3-1-nginx" class="headerlink" title="3.1 nginx"></a>3.1 nginx</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs SHELL"><span class="hljs-meta prompt_">#</span><span class="language-bash">拉取Nginx镜像</span><br>[root@hadoop1 ~]# docker pull nginx<br>Using default tag: latest<br>latest: Pulling from library/nginx<br>b380bbd43752: Pull complete <br>fca7e12d1754: Pull complete <br>745ab57616cb: Pull complete <br>a4723e260b6f: Pull complete <br>1c84ebdff681: Pull complete <br>858292fd2e56: Pull complete <br>Digest: sha256:644a70516a26004c97d0d85c7fe1d0c3a67ea8ab7ddf4aff193d9f301670cf36<br>Status: Downloaded newer image for nginx:latest<br>docker.io/library/nginx:latest<br>[root@hadoop1 ~]# docker images<br>REPOSITORY   TAG       IMAGE ID       CREATED       SIZE<br>nginx        latest    87a94228f133   2 weeks ago   133MB<br>centos       latest    5d0da3dc9764   6 weeks ago   231MB<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">运行容器</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">-d 后台运行</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">--name 给容器取别名</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">-p 添加端口映射</span><br>[root@hadoop1 ~]# docker run -d --name nginx1 -p 3344:80 nginx<br>d168c9aa2b2ce062aba6d92c9650f13c036aa98bf37fd1952e7a7d4029aea13c<br>[root@hadoop1 ~]# docker ps<br>CONTAINER ID   IMAGE     COMMAND                  CREATED         STATUS         PORTS                                   NAMES<br>d168c9aa2b2c   nginx     &quot;/docker-entrypoint.…&quot;   9 seconds ago   Up 7 seconds   0.0.0.0:3344-&gt;80/tcp, :::3344-&gt;80/tcp   nginx1<br><br>docker run -d --name nginx01 -p 80:80 -v /home/nginx/conf/nginx.conf:/etc/nginx/nginx.conf -v /home/nginx/logs:/var/log/nginx nginx<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">通过192.168.100.130:3344即可访问nginx</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">可以进入容器中修改对应配置文件----&gt;后续通过数据卷形式进行文件映射修改</span><br><br><br><br><br></code></pre></td></tr></table></figure>

<h5 id="3-2-tomcat"><a href="#3-2-tomcat" class="headerlink" title="3.2 tomcat"></a>3.2 tomcat</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs SHELL"><span class="hljs-meta prompt_">#</span><span class="language-bash">拉取镜像</span><br>[root@hadoop1 ~]# docker pull tomcat<br>Using default tag: latest<br>latest: Pulling from library/tomcat<br>bb7d5a84853b: Pull complete <br>f02b617c6a8c: Pull complete <br>d32e17419b7e: Pull complete <br>c9d2d81226a4: Extracting  54.57MB/54.57MB<br>fab4960f9cd2: Download complete <br>da1c1e7baf6d: Download complete <br>1d2ade66c57e: Download complete <br>ea2ad3f7cb7c: Download complete <br>d75cb8d0a5ae: Download complete <br>76c37a4fffe6: Download complete <br>latest: Pulling from library/tomcat<br><br><br><br><br></code></pre></td></tr></table></figure>

<h3 id="4-可视化工具-portainer"><a href="#4-可视化工具-portainer" class="headerlink" title="4 可视化工具(portainer)"></a>4 可视化工具(portainer)</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs SHELL"><span class="hljs-meta prompt_"># </span><span class="language-bash">安装</span><br>docker run -d -p 8088:9000 --restart=always -v /var/run/docker.sock:/var/run/docker.sock --privileged=true portainer/portainer<br><span class="hljs-meta prompt_"> </span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">测试</span><br>[root@iZ2zeg4ytp0whqtmxbsqiiZ home]# curl localhost:8088<br>&lt;!DOCTYPE html<br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">&lt;html lang=<span class="hljs-string">&quot;en&quot;</span> ng-app=<span class="hljs-string">&quot;portainer&quot;</span>&gt;</span><br><span class="hljs-meta prompt_"> </span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">外网访问 http://ip:8088</span> <br> <br><br><br></code></pre></td></tr></table></figure>

<h3 id="5-Docker原理"><a href="#5-Docker原理" class="headerlink" title="5 Docker原理"></a>5 Docker原理</h3><p> Docker镜像都是只读的，当容器启动时， 一个新的可写层被加载到镜像的顶部！</p>
<p> 这一层就是我们通常说的容器层， 容器之下的都叫做镜像层</p>
<p>理解: 拉取镜像后会有最底下的一层—&gt;镜像层 ,当通过修改变更后会在该层上加上一层 —&gt; 容器层</p>
<h3 id="6-提交自定义镜像"><a href="#6-提交自定义镜像" class="headerlink" title="6 提交自定义镜像"></a>6 提交自定义镜像</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs SHELL">docker commit 提交容器成为一个新的版本<br><span class="hljs-meta prompt_"> </span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">命令和git 原理类似</span><br>docker commit -m=&quot;提交的描述信息&quot; -a=&quot;作者&quot; 容器id 目标镜像名：[TAG]<br> <br>docker commit -a=&quot;xiaofan&quot; -m=&quot;add webapps app&quot; d798a5946c1f tomcat007:1.0<br> <br><br><br></code></pre></td></tr></table></figure>

<h3 id="7-容器数据卷"><a href="#7-容器数据卷" class="headerlink" title="7 容器数据卷"></a>7 容器数据卷</h3><h5 id="7-1-使用数据卷"><a href="#7-1-使用数据卷" class="headerlink" title="7.1 使用数据卷"></a>7.1 使用数据卷</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs SHELL"><span class="hljs-meta prompt_"># </span><span class="language-bash">docker run -it -v 主机地址:容器地址 镜像名 /bin/bash</span><br>[root@hadoop1 ~]# docker run -it -v /home/ceshi:/home centos /bin/bash<br>[root@hadoop1 ~]# docker inspect 7f9c8191ddb0 #查询镜像详细信息<br> &quot;Mounts&quot;: [<br>            &#123;<br>                &quot;Type&quot;: &quot;bind&quot;,<br>                &quot;Source&quot;: &quot;/home/ceshi&quot;, #映射主机地址<br>                &quot;Destination&quot;: &quot;/home&quot;, #容器地址<br>                &quot;Mode&quot;: &quot;&quot;,<br>                &quot;RW&quot;: true,<br>                &quot;Propagation&quot;: &quot;rprivate&quot;<br>            &#125;<br>        ],<br><br><br><br><br></code></pre></td></tr></table></figure>

<h5 id="7-2-实战–-同步mysql数据"><a href="#7-2-实战–-同步mysql数据" class="headerlink" title="7.2 实战–&gt;同步mysql数据"></a>7.2 实战–&gt;同步mysql数据</h5><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-comment">#-e MYSQL_ROOT_PASSWORD=密码 </span><br>[root@hadoop1 ~] docker run -d -p <span class="hljs-number">3344</span>:<span class="hljs-number">3306</span> -v <span class="hljs-regexp">/home/my</span>sql<span class="hljs-regexp">/conf:/</span>etc<span class="hljs-regexp">/mysql/</span>conf.d -v <span class="hljs-regexp">/home/my</span>sql<span class="hljs-regexp">/data:/</span>var<span class="hljs-regexp">/lib/my</span>sql -e MYSQL_ROOT_PASSWORD=<span class="hljs-number">123456</span> --name mysql01 mysql:<span class="hljs-number">5.7</span><br><br>SHELL<br></code></pre></td></tr></table></figure>

<h5 id="7-3-具名挂载和匿名挂载"><a href="#7-3-具名挂载和匿名挂载" class="headerlink" title="7.3 具名挂载和匿名挂载"></a>7.3 具名挂载和匿名挂载</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs SHELL"><span class="hljs-meta prompt_"># </span><span class="language-bash">匿名挂载</span><br>-v 容器内路径<br>docker run -d -P --name nginx01 -v /etc/nginx nginx     # -P 随机指定端口<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">具名挂载</span><br>-v 卷名:容器内路径<br>[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker run -d -P --name nginx02 -v juming-nginx:/etc/nginx nginx<br><br>[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker volume ls #查看所有卷<br>DRIVER              VOLUME NAME<br>local               561b81a03506f31d45ada3f9fb7bd8d7c9b5e0f826c877221a17e45d4c80e096<br>local               36083fb6ca083005094cbd49572a0bffeec6daadfbc5ce772909bb00be760882<br>local               juming-nginx<br><span class="hljs-meta prompt_"> </span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">通过-v 卷名：容器内的路径</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">查看一下这个卷</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">docker volume inspect juming-nginx</span><br> <br>[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker volume inspect juming-nginx #查看指定卷的详细信息<br>[<br>  &#123;<br>      &quot;CreatedAt&quot;: &quot;2020-08-12T18:15:21+08:00&quot;,<br>      &quot;Driver&quot;: &quot;local&quot;,<br>      &quot;Labels&quot;: null,<br>      &quot;Mountpoint&quot;: &quot;/var/lib/docker/volumes/juming-nginx/_data&quot;, #默认映射主机路径<br>      &quot;Name&quot;: &quot;juming-nginx&quot;,<br>      &quot;Options&quot;: null,<br>      &quot;Scope&quot;: &quot;local&quot;<br>  &#125;<br>]<br><br><br></code></pre></td></tr></table></figure>

<h3 id="8-初始化DockerFile"><a href="#8-初始化DockerFile" class="headerlink" title="8 初始化DockerFile"></a>8 初始化DockerFile</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs SHELL"><span class="hljs-meta prompt_"># </span><span class="language-bash">创建一个dockerfile文件， 名字可以随机</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">文件的内容 指定（大写） 参数</span><br> <br>FROM centos<br> <br>VOLUME [&quot;volume01&quot;, &quot;volume02&quot;] #匿名挂载路径<br> <br>CMD echo &quot;----end----&quot;<br>CMD /bin/bash<br><span class="hljs-meta prompt_"> </span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">这里的每一个命令都是镜像的一层！</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">docker build -f dockerfile文件绝对路径 -t 自定义镜像名 . (不要忘记一个点)</span><br><br>[root@iZ2vcb4sibyek91jif7g03Z dockerfile]# docker build -f /home/dockerfile/dockerfile01 -t lier/centos:1.0 .<br>Sending build context to Docker daemon  2.048kB<br>Step 1/4 : FROM centos<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">5d0da3dc9764</span><br>Step 2/4 : VOLUME [&quot;vloume01&quot;,&quot;volume02&quot;]<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">Running <span class="hljs-keyword">in</span> 9550fd50fff9</span><br>Removing intermediate container 9550fd50fff9<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">790b5202eee3</span><br>Step 3/4 : CMD echo &quot;-------success--------&quot;<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">Running <span class="hljs-keyword">in</span> 59756290379d</span><br>Removing intermediate container 59756290379d<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">7ea7e620d7fa</span><br>Step 4/4 : CMD /bin/bash<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">Running <span class="hljs-keyword">in</span> da0c4b28015e</span><br>Removing intermediate container da0c4b28015e<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">68dcb8f250e4</span><br>Successfully built 68dcb8f250e4<br>Successfully tagged lier/centos:1.0<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">dockerfile文件中匿名挂载路径</span><br> &quot;Mounts&quot;: [<br>            &#123;<br>                &quot;Type&quot;: &quot;volume&quot;,<br>                &quot;Name&quot;: &quot;01f9bbe5582271a8349fa997263ba2e5189d683a8522cd64e4a94650fa4623b6&quot;,<br>                &quot;Source&quot;: &quot;/var/lib/docker/volumes/01f9bbe5582271a8349fa997263ba2e5189d683a8522cd64e4a94650fa4623b6/_data&quot;,<br>                &quot;Destination&quot;: &quot;vloume01&quot;,<br>                &quot;Driver&quot;: &quot;local&quot;,<br>                &quot;Mode&quot;: &quot;&quot;,<br>                &quot;RW&quot;: true,<br>                &quot;Propagation&quot;: &quot;&quot;<br>            &#125;,<br>            &#123;<br>                &quot;Type&quot;: &quot;volume&quot;,<br>                &quot;Name&quot;: &quot;14d4f110646e3490fc9cd8b44c533c391a8a764697cef969cab6d27a7ae94df4&quot;,<br>                &quot;Source&quot;: &quot;/var/lib/docker/volumes/14d4f110646e3490fc9cd8b44c533c391a8a764697cef969cab6d27a7ae94df4/_data&quot;,<br>                &quot;Destination&quot;: &quot;volume02&quot;,<br>                &quot;Driver&quot;: &quot;local&quot;,<br>                &quot;Mode&quot;: &quot;&quot;,<br>                &quot;RW&quot;: true,<br>                &quot;Propagation&quot;: &quot;&quot;<br>            &#125;<br>        ],<br><br><br><br></code></pre></td></tr></table></figure>

<h3 id="9-数据卷容器"><a href="#9-数据卷容器" class="headerlink" title="9 数据卷容器"></a>9 数据卷容器</h3><p>使得多台容器间数据同步,共用数据,只要有一台容器在数据就不会丢失,全部容器丢失后,持久化的数据也不会丢失</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs SHELL"><span class="hljs-meta prompt_">#</span><span class="language-bash">先启动一台作为数据卷容器</span><br>[root@iZ2vcb4sibyek91jif7g03Z dockerfile]# docker run -it --name liercentos01 liercentos:2.0<br>[root@00d779cd2466 /]# [root@iZ2vcb4sibyek91jif7g03Z dockerfile]# docker ps<br>CONTAINER ID   IMAGE            COMMAND                  CREATED         STATUS         PORTS     NAMES<br>00d779cd2466   liercentos:2.0   &quot;/bin/sh -c /bin/bash&quot;   9 seconds ago   Up 9 seconds             liercentos01<br><span class="hljs-meta prompt_">#</span><span class="language-bash">启动第二台容器使用--volumes-from 实现数据同步</span> <br>[root@iZ2vcb4sibyek91jif7g03Z dockerfile]# docker run -it --name liercnetos02 --volumes-from liercentos01 liercentos:2.0<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">进入该容器使用 <span class="hljs-built_in">ls</span> -al 发现目录与liercentos01 一致</span><br><br><br><br><br><br></code></pre></td></tr></table></figure>

<h3 id="10-DockerFile详解"><a href="#10-DockerFile详解" class="headerlink" title="10 DockerFile详解"></a>10 DockerFile详解</h3><p>dockerFile是用来构建docker镜像的文件！命令参数脚本！</p>
<h5 id="10-1构建步骤"><a href="#10-1构建步骤" class="headerlink" title="10.1构建步骤"></a>10.1构建步骤</h5><p>一: 编写一个dockerFile文件</p>
<p>二: docker build 构建成为一个镜像</p>
<p>三: docker run 运行镜像</p>
<p>四: docker push 发布镜像（DockerHub、阿里云镜像）</p>
<h5 id="10-2-dockerfile构建过程"><a href="#10-2-dockerfile构建过程" class="headerlink" title="10.2 dockerfile构建过程"></a>10.2 dockerfile构建过程</h5><h6 id="10-2-1-基础知识"><a href="#10-2-1-基础知识" class="headerlink" title="10.2.1 基础知识"></a>10.2.1 基础知识</h6><p> 每个保留关键字（指令）都是必须大写字母</p>
<p> 执行从上到下顺序执行</p>
<p> #&#96; 表示注释</p>
<p> 每个指令都会创建提交一个新的镜像层，并提交!</p>
<h6 id="10-2-2-相关概念"><a href="#10-2-2-相关概念" class="headerlink" title="10.2.2 相关概念"></a>10.2.2 相关概念</h6><p> DockerFile： 构建文件， 定义了一切的步骤，源代码</p>
<p> DockerImages： 通过DockerFile构建生成的镜像， 最终发布和运行的产品！</p>
<p> Docker容器：容器就是镜像运行起来提供服务器</p>
<p> 10.3.3 相关命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs SHELL">FROM            # 基础镜像，一切从这里开始构建<br>MAINTAINER      # 镜像是谁写的， 姓名+邮箱<br>RUN             # 镜像构建的时候需要运行的命令<br>ADD             # 步骤， tomcat镜像， 这个tomcat压缩包！添加内容<br>WORKDIR         # 镜像的工作目录<br>VOLUME          # 挂载的目录<br>EXPOSE          # 保留端口配置<br>CMD             # 指定这个容器启动的时候要运行的命令，只有最后一个会生效可被替代<br>ENTRYPOINT      # 指定这个容器启动的时候要运行的命令， 可以追加命令<br>ONBUILD         # 当构建一个被继承DockerFile 这个时候就会运行 ONBUILD 的指令，触发指令<br>COPY            # 类似ADD, 将我们文件拷贝到镜像中<br>ENV             # 构建的时候设置环境变量！<br><br><br></code></pre></td></tr></table></figure>

<h5 id="10-3-实战"><a href="#10-3-实战" class="headerlink" title="10.3 实战"></a>10.3 实战</h5><h6 id="10-3-1-构建自己的centos"><a href="#10-3-1-构建自己的centos" class="headerlink" title="10.3.1 构建自己的centos"></a>10.3.1 构建自己的centos</h6><p> 需求:原生的centos没有 vim指令 和 ifconfig指令 —-&gt; 构建添加这两个指令的centos系统</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs SHELL"><span class="hljs-meta prompt_"># </span><span class="language-bash">构建相关的dockerfile文件</span><br>FROM centos<br>MAINTRINER lier&lt;664478853@qq.com&gt;<br><br>ENV MYPATH /usr/local   #配置环境路径变量<br>WORKDIR $MYPATH<br><br>RUN yum -y install vim  #安装vim工具<br>RUN yum -y install net-tools #安装网络工具<br><br>EXPOSE 80 #暴露80端口<br><br>CMD echo &quot;--------success--------&quot;<br>CMD echo $MYPATH<br>CMD /bin/bash<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">根据DockerFile文件构建镜像</span><br>[root@iZ2vcb4sibyek91jif7g03Z dockerfile-centos]# docker build -f /home/dockerfile-centos/DockerFile -t mycentos:1.0 .<br>Sending build context to Docker daemon  2.048kB<br>Step 1/10 : FROM centos<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">5d0da3dc9764</span><br>Step 2/10 : MAINTAINER lier&lt;664478853@qq.com&gt;<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">Running <span class="hljs-keyword">in</span> 5893c1eeb855</span><br>Removing intermediate container 5893c1eeb855<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">6c473ed6363b</span><br>Step 3/10 : ENV MYPATH /usr/local   #配置环境路径变量<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">Running <span class="hljs-keyword">in</span> e475927a66bd</span><br>Removing intermediate container e475927a66bd<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">33dd18a7a31e</span><br>Step 4/10 : WORKDIR $MYPATH<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">Running <span class="hljs-keyword">in</span> 93f481d11774</span><br>Removing intermediate container 93f481d11774<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">349ecdd33ae2</span><br>Step 5/10 : ADD yum -y install vim  #安装vim工具<br>ADD failed: file not found in build context or excluded by .dockerignore: stat yum: file does not exist<br><br><br><br></code></pre></td></tr></table></figure>

<h6 id="10-3-2-构建发布tomcat"><a href="#10-3-2-构建发布tomcat" class="headerlink" title="10.3.2 构建发布tomcat"></a>10.3.2 构建发布tomcat</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs SHELL"><span class="hljs-meta prompt_"># </span><span class="language-bash">dockerfile 文件</span><br>FROM centos<br>MAINTAINER lier&lt;664478853@qq.com&gt;<br><br>COPY readme.txt /usr/local/readme.txt<br><br>ADD apache-tomcat-9.0.37.tar.gz  /usr/local<br>ADD jdk-8u261-linux-x64.tar.gz   /usr/local<br><br>RUN yum -y install vim<br><br>ENV MYPATH /usr/local<br>WORKDIR $MYPATH<br><br><br>ENV JAVA_HOME /usr/local/jdk2.8.0_261<br>ENV CLASSPATH $JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar<br><br>ENV CATALINA_HOME /usr/local/apache-tomcat-9.0.37<br>ENV CATALINA_BASH /usr/local/apache-tomcat-9.0.37<br>ENV PATH $PATH:$JAVA_HOME/bin:$CATALINA_HOME/lib:$CATALINA_HOME/bin<br><br>EXPOSE 8080<br><br><br>CMD /usr/local/apache-tomcat-9.0.37/bin/startup.sh &amp;&amp; tail -F /usr/local/apache-tomcat-9.0.37/logs/catalina.out<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">构建镜像</span><br>[root@iZ2vcb4sibyek91jif7g03Z tomcat-docker]# docker build -t mytomcat .<br>Sending build context to Docker daemon  154.3MB<br>Step 1/15 : FROM centos<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">5d0da3dc9764</span><br>Step 2/15 : MAINTAINER lier&lt;664478853@qq.com&gt;<br>.....<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">运行</span><br>[root@iZ2vcb4sibyek91jif7g03Z tomcat-docker]# docker run -d -p 3344:8080 --name mytomcat1.0 mytomcat<br>9b59ad5431cd96f5192840a626c5f295cb4cc3aa33f027b96b70ff56fac3f7f2<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">测试</span><br><br>[root@iZ2vcb4sibyek91jif7g03Z tomcat-docker]# curl localhost:3344<br><br>&lt;!DOCTYPE html&gt;<br>&lt;html lang=&quot;en&quot;&gt;<br>    &lt;head&gt;<br><br><br><br><br></code></pre></td></tr></table></figure>

<h5 id="10-4-发布镜像"><a href="#10-4-发布镜像" class="headerlink" title="10.4 发布镜像"></a>10.4 发布镜像</h5><h6 id="10-4-1-发送到dockerhub"><a href="#10-4-1-发送到dockerhub" class="headerlink" title="10.4.1 发送到dockerhub"></a>10.4.1 发送到dockerhub</h6><p> ①: 创建自己的dockerhub账号,通过 docker login –username&#x3D;username –password&#x3D;password 登录</p>
<p> ②: 通过 docker tag 镜像名 自定义镜像名:版本号 —&gt;第一版本标识,如果镜像已有标识版本可以忽略</p>
<p> ③: docker push 镜像名:版本号 进行提交</p>
<h6 id="10-4-2-发送镜像到阿里云"><a href="#10-4-2-发送镜像到阿里云" class="headerlink" title="10.4.2 发送镜像到阿里云"></a>10.4.2 发送镜像到阿里云</h6><p> 登录阿里云,在容器镜像服务中创建命名空间,在命名空间中创建镜像仓库,分局提示步骤上船镜像即可</p>
<h3 id="11-Docker网络"><a href="#11-Docker网络" class="headerlink" title="11 Docker网络"></a>11 Docker网络</h3><h5 id="11-1-docker0"><a href="#11-1-docker0" class="headerlink" title="11.1 docker0"></a>11.1 docker0</h5><p> 原理: 我们每启动一个docker容器， docker就会给docker容器分配一个ip， 我们只要安装了docker，就会有一个网卡 docker0桥接模式，使用的技术是veth-pair技术！</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs SHELL"><span class="hljs-meta prompt_"># </span><span class="language-bash">我们发现这个容器带来网卡，都是一对对的</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">veth-pair 就是一对的虚拟设备接口，他们都是成对出现的，一端连着协议，一端彼此相连</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">正因为有这个特性，veth-pair充当一个桥梁， 连接各种虚拟网络设备</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">OpenStac， Docker容器之间的链接，OVS的链接， 都是使用veth-pair技术</span><br><br><br></code></pre></td></tr></table></figure>

<h5 id="11-2-相关测试结论"><a href="#11-2-相关测试结论" class="headerlink" title="11.2 相关测试结论"></a>11.2 相关测试结论</h5><p>启动两个容器,因为他们默认使用同一个网卡docker0,所以可以相互ping通</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs SHELL"><span class="hljs-meta prompt_"># </span><span class="language-bash">启动两个容器 tomcat01 tomcat02</span><br>[root@iZ2vcb4sibyek91jif7g03Z ~]# docker ps<br>CONTAINER ID   IMAGE     COMMAND             CREATED         STATUS         PORTS      NAMES<br>599a796e4438   tomcat    &quot;catalina.sh run&quot;   3 seconds ago   Up 3 seconds   8080/tcp   tomcat02<br>485a3230a747   tomcat    &quot;catalina.sh run&quot;   9 seconds ago   Up 9 seconds   8080/tcp   tomcat01<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">使用ifconfig 或者 ip addr 查看 ---&gt; 容器网卡成对出现 (使用的技术是veth-pair技术！)</span><br>[root@iZ2vcb4sibyek91jif7g03Z ~]# ifconfig<br>vethfb3c521: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500<br>        ether fa:32:f0:63:66:31  txqueuelen 0  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br><br>vethfc64237: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500<br>        ether 3a:ac:52:4a:d5:92  txqueuelen 0  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br>        <br><span class="hljs-meta prompt_"># </span><span class="language-bash">dokcer network <span class="hljs-built_in">ls</span> 查看网卡<span class="hljs-built_in">id</span></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">docker network inspect 网卡<span class="hljs-built_in">id</span> 查看指定网卡下的容器信息</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">docker <span class="hljs-built_in">exec</span> -it 容器名 ping 其他同网段容器ip</span><br><br><br></code></pre></td></tr></table></figure>

<h5 id="11-3-–link"><a href="#11-3-–link" class="headerlink" title="11.3 –link"></a>11.3 –link</h5><p> 每次重启容器之后ip会变化 使用–link 之后 可使用容器名,类似于微服务调用 feign</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs SHELL">[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker exec -it tomcat02 ping tomcat01<br>ping: tomcat01: Name or service not known<br><span class="hljs-meta prompt_"> </span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">如何可以解决呢？</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">通过--<span class="hljs-built_in">link</span>既可以解决网络连通问题</span><br>[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker run -d -P  --name tomcat03 --link tomcat02 tomcat<br>3a2bcaba804c5980d94d168457c436fbd139820be2ee77246888f1744e6bb473<br>[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker ps<br>CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                     NAMES<br>3a2bcaba804c        tomcat              &quot;catalina.sh run&quot;   4 seconds ago       Up 3 seconds        0.0.0.0:32772-&gt;8080/tcp   tomcat03<br>f22ed47ed1be        tomcat              &quot;catalina.sh run&quot;   57 minutes ago      Up 57 minutes       0.0.0.0:32771-&gt;8080/tcp   tomcat02<br>9d97f93401a0        tomcat              &quot;catalina.sh run&quot;   About an hour ago   Up About an hour    0.0.0.0:32770-&gt;8080/tcp   tomcat01<br>[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker exec -it tomcat03 ping tomcat02<br>PING tomcat02 (172.17.0.3) 56(84) bytes of data.<br>64 bytes from tomcat02 (172.17.0.3): icmp_seq=1 ttl=64 time=0.129 ms<br>64 bytes from tomcat02 (172.17.0.3): icmp_seq=2 ttl=64 time=0.100 ms<br>64 bytes from tomcat02 (172.17.0.3): icmp_seq=3 ttl=64 time=0.110 ms<br>64 bytes from tomcat02 (172.17.0.3): icmp_seq=4 ttl=64 time=0.107 ms<br><span class="hljs-meta prompt_"> </span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">反向可以ping通吗？</span><br>[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker exec -it tomcat02 ping tomcat03<br>ping: tomcat03: Name or service not known<br><span class="hljs-meta prompt_"># </span><span class="language-bash">反向需要再次使用--<span class="hljs-built_in">link</span>反向绑定</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">其原理就是在hosts文件中 配置了一个 ip 映射</span><br><br><br></code></pre></td></tr></table></figure>

<h5 id="11-4-自定义网络"><a href="#11-4-自定义网络" class="headerlink" title="11.4 自定义网络"></a>11.4 自定义网络</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs SHELL"><span class="hljs-meta prompt_"># </span><span class="language-bash">网络相关指令 ---&gt; docker network --<span class="hljs-built_in">help</span> 查看</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">默认网卡 docker0 ---&gt;driver</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">创建网卡 docker  network create --<span class="hljs-built_in">help</span>  查看帮助</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">--subnet 子网</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">--gateway 网关</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">docker network create [options] 网卡名</span><br><br>[root@iZ2vcb4sibyek91jif7g03Z ~]# docker network create --subnet 192.168.0.1/16 --gateway 192.168.0.2 mynet<br>a7af152329fbb85c02ea8cd88dc827780b4b7533e3d4a725c490a8c28fdd71a2<br>[root@iZ2vcb4sibyek91jif7g03Z ~]# docker network ls<br>NETWORK ID     NAME      DRIVER    SCOPE<br>ae14bdd28933   bridge    bridge    local<br>01b0b3743f52   host      host      local<br>a7af152329fb   mynet     bridge    local<br>f59f8ebc617a   none      null      local<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">运行容器时指定网卡---&gt; --net</span><br>[root@iZ2vcb4sibyek91jif7g03Z ~]# clear<br>[root@iZ2vcb4sibyek91jif7g03Z ~]# docker run -d -P --name tomcat03 --net mynet tomcat<br>f2de1e2ab7fe3cb5de6bdbd98863b1fc051881e97397bdfc91f602d3a468713f<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">使用自定义网卡之后, 不用--<span class="hljs-built_in">link</span> 也可以ping名字,定义的网络docker都已经帮我们维护好了对应的关系</span><br><br><br></code></pre></td></tr></table></figure>

<h5 id="11-5-网络连通"><a href="#11-5-网络连通" class="headerlink" title="11.5 网络连通"></a>11.5 网络连通</h5><p> 指使用不同网卡的两个容器之间的网络连接</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs SHELL">[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker network connect  mynet tomcat01 #打通默认网卡下的容器tomcat01 与 mynet<br><span class="hljs-meta prompt_"># </span><span class="language-bash">这样亮哥不同网段之间的容器就可相互ping通</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">连通之后就是讲tomcat01 放到了mynet网路下</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">一个容器两个ip地址：</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">阿里云服务器，公网ip，私网ip</span><br><br><br></code></pre></td></tr></table></figure>

<h5 id="11-6-实战部署redis"><a href="#11-6-实战部署redis" class="headerlink" title="11.6 实战部署redis"></a>11.6 实战部署redis</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><code class="hljs SHELL"><span class="hljs-meta prompt_"># </span><span class="language-bash">创建自定义网卡 redis</span><br>[root@iZ2vcb4sibyek91jif7g03Z ~]# docker network create --subnet 192.160.0.1/16 --gateway 192.160.0.2 redis<br>387b51203fba1462a1b51b95b89e9f38aecfc5b653caebec0dff8a74c003a6c7<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">通过脚本创建六个redis配置</span><br>for port in $(seq 1 6);<br>do<br>mkdir -p /mydata/redis/node-$&#123;port&#125;/conf<br>touch /mydata/redis/node-$&#123;port&#125;/conf/redis.conf<br>cat &lt;&lt; EOF &gt;/mydata/redis/node-$&#123;port&#125;/conf/redis.conf<br>port 6379<br>bind 0.0.0.0<br>cluster-enabled yes<br>cluster-config-file nodes.conf<br>cluster-node-timeout 5000<br>cluster-announce-ip 192.160.0.1$&#123;port&#125;<br>cluster-announce-port 6379<br>cluster-announce-bus-port 16379<br>appendonly yes<br>EOF<br>done<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">创建节点</span><br>docker run -p 6371:6379 -p 16371:16379 --name redis-1 \<br>-v /mydata/redis/node-1/data:/data \<br>-v /mydata/redis/node-1/conf/redis.conf:/etc/redis/redis.conf \<br>-d --net redis --ip 192.160.0.11 redis:5.0.9-alpine3.11 redis-server /etc/redis/redis.conf<br><span class="hljs-meta prompt_"> </span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">创建结点2</span><br>docker run -p 6372:6379 -p 16372:16379 --name redis-2 \<br>-v /mydata/redis/node-2/data:/data \<br>-v /mydata/redis/node-2/conf/redis.conf:/etc/redis/redis.conf \<br>-d --net redis --ip 192.160.0.12 redis:5.0.9-alpine3.11 redis-server /etc/redis/redis.conf<br><span class="hljs-meta prompt_">#</span><span class="language-bash">创建结点3</span><br>docker run -p 6373:6379 -p 16373:16379 --name redis-3 \<br>-v /mydata/redis/node-3/data:/data \<br>-v /mydata/redis/node-3/conf/redis.conf:/etc/redis/redis.conf \<br>-d --net redis --ip 192.160.0.13 redis:5.0.9-alpine3.11 redis-server /etc/redis/redis.conf<br><span class="hljs-meta prompt_">#</span><span class="language-bash">创建结点4</span><br>docker run -p 6374:6379 -p 16374:16379 --name redis-4 \<br>-v /mydata/redis/node-4/data:/data \<br>-v /mydata/redis/node-4/conf/redis.conf:/etc/redis/redis.conf \<br>-d --net redis --ip 192.160.0.14 redis:5.0.9-alpine3.11 redis-server /etc/redis/redis.conf<br><span class="hljs-meta prompt_">#</span><span class="language-bash">创建结点5</span><br>docker run -p 6375:6379 -p 16375:16379 --name redis-5 \<br>-v /mydata/redis/node-5/data:/data \<br>-v /mydata/redis/node-5/conf/redis.conf:/etc/redis/redis.conf \<br>-d --net redis --ip 192.160.0.15 redis:5.0.9-alpine3.11 redis-server /etc/redis/redis.conf<br><span class="hljs-meta prompt_">#</span><span class="language-bash">创建结点6</span><br>docker run -p 6376:6379 -p 16376:16379 --name redis-6 \<br>-v /mydata/redis/node-6/data:/data \<br>-v /mydata/redis/node-6/conf/redis.conf:/etc/redis/redis.conf \<br>-d --net redis --ip 192.160.0.16 redis:5.0.9-alpine3.11 redis-server /etc/redis/redis.conf<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">查看执行成功</span><br>[root@iZ2vcb4sibyek91jif7g03Z redis]# docker ps<br>CONTAINER ID   IMAGE                    COMMAND                  CREATED              STATUS              PORTS                                              NAMES<br>25f1b0314aa7   redis:5.0.9-alpine3.11   &quot;docker-entrypoint.s…&quot;   6 seconds ago        Up 5 seconds        0.0.0.0:6376-&gt;6379/tcp, 0.0.0.0:16376-&gt;16379/tcp   redis-6<br>ad550f0ab391   redis:5.0.9-alpine3.11   &quot;docker-entrypoint.s…&quot;   12 seconds ago       Up 11 seconds       0.0.0.0:6375-&gt;6379/tcp, 0.0.0.0:16375-&gt;16379/tcp   redis-5<br>8bd65b125ad2   redis:5.0.9-alpine3.11   &quot;docker-entrypoint.s…&quot;   21 seconds ago       Up 20 seconds       0.0.0.0:6374-&gt;6379/tcp, 0.0.0.0:16374-&gt;16379/tcp   redis-4<br>d30cefb7c53d   redis:5.0.9-alpine3.11   &quot;docker-entrypoint.s…&quot;   32 seconds ago       Up 31 seconds       0.0.0.0:6373-&gt;6379/tcp, 0.0.0.0:16373-&gt;16379/tcp   redis-3<br>690e1190687c   redis:5.0.9-alpine3.11   &quot;docker-entrypoint.s…&quot;   48 seconds ago       Up 47 seconds       0.0.0.0:6372-&gt;6379/tcp, 0.0.0.0:16372-&gt;16379/tcp   redis-2<br>39439b1d7806   redis:5.0.9-alpine3.11   &quot;docker-entrypoint.s…&quot;   About a minute ago   Up About a minute   0.0.0.0:6371-&gt;6379/tcp, 0.0.0.0:16371-&gt;16379/tcp   redis-1<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">创建集群</span> <br>[root@iZ2vcb4sibyek91jif7g03Z ~]# docker exec -it redis-1 /bin/sh #进入随机一台redis<br>/data # redis-cli --cluster create 192.160.0.11:6379 192.160.0.12:6379 192.160.0.13:6379 192.160.0.14:6379 192.160.0.15:6379 192.160.0.16:6379 --cluster-replicas 1<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">&gt;&gt; Performing <span class="hljs-built_in">hash</span> slots allocation on 6 nodes...</span><br>Master[0] -&gt; Slots 0 - 5460<br>Master[1] -&gt; Slots 5461 - 10922<br>Master[2] -&gt; Slots 10923 - 16383<br>Adding replica 192.160.0.15:6379 to 192.160.0.11:6379<br>Adding replica 192.160.0.16:6379 to 192.160.0.12:6379<br>Adding replica 192.160.0.14:6379 to 192.160.0.13:6379<br>M: a60a08d2ca7edc6cf09d1b5adf07ee3010550e8b 192.160.0.11:6379<br>   slots:[0-5460] (5461 slots) master<br>M: f3ef7f0c4b2ec73e5727b94a18e4e3145fa9201e 192.160.0.12:6379<br>   slots:[5461-10922] (5462 slots) master<br>M: ca12d5b42f0a5056870cda9107ccc1cba3e0c737 192.160.0.13:6379<br>   slots:[10923-16383] (5461 slots) master<br>S: 184726ccd46dbbce9cee2170dacd9c26e70c4986 192.160.0.14:6379<br>   replicates ca12d5b42f0a5056870cda9107ccc1cba3e0c737<br>S: a22cb6735f42c1b8462964b196ebef051769db72 192.160.0.15:6379<br>   replicates a60a08d2ca7edc6cf09d1b5adf07ee3010550e8b<br>S: 4a8e465f40a619e5f556d4075ce98e3316d35ac3 192.160.0.16:6379<br>   replicates f3ef7f0c4b2ec73e5727b94a18e4e3145fa9201e<br><br>docker run -p 6379:6379 --name yyghredis -d -v /home/redis/data:/data<br>-v /home/redis/conf/redis.conf:/etc/redis/redis.conf redis:<br><br><br></code></pre></td></tr></table></figure>

<h4 id="12-SpringBoot微服务打包Docker镜像"><a href="#12-SpringBoot微服务打包Docker镜像" class="headerlink" title="12.SpringBoot微服务打包Docker镜像"></a>12.SpringBoot微服务打包Docker镜像</h4><p> 12.1 创建helloword–springboot程序 并打包</p>
<p> 12.2 编写DockerFile</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs Shell">FROM java:8<br> <br>COPY *.jar /app.jar<br> <br>CMD [&quot;--server.port=8080&quot;]<br> <br>EXPOSE 8080<br> <br>ENTRYPOINT [&quot;java&quot;, &quot;-jar&quot;, &quot;/app.jar&quot;]<br><br>DOCKERFILE<br></code></pre></td></tr></table></figure>

<p> 12.3 将打包后的jar和DockerFile发送的linux中,并构建镜像</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs SHELL"><span class="hljs-meta prompt_"># </span><span class="language-bash">把打好的jar包和Dockerfile上传到linux</span><br>[root@iZ2zeg4ytp0whqtmxbsqiiZ idea]# ll<br>total 16140<br>-rw-r--r-- 1 root root 16519871 Aug 14 17:38 demo-0.0.1-SNAPSHOT.jar<br>-rw-r--r-- 1 root root      122 Aug 14 17:38 Dockerfile<br><span class="hljs-meta prompt_"> </span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">构建镜像，不要忘了最后有一个点</span><br>[root@iZ2zeg4ytp0whqtmxbsqiiZ idea]# docker build -t xiaofan666 .<br>Sending build context to Docker daemon  16.52MB<br>Step 1/5 : FROM java:8<br>8: Pulling from library/java<br>5040bd298390: Pull complete <br>fce5728aad85: Pull complete <br>76610ec20bf5: Pull complete <br>60170fec2151: Pull complete <br>e98f73de8f0d: Pull complete <br>11f7af24ed9c: Pull complete <br>49e2d6393f32: Pull complete <br>bb9cdec9c7f3: Pull complete <br>Digest: sha256:c1ff613e8ba25833d2e1940da0940c3824f03f802c449f3d1815a66b7f8c0e9d<br>Status: Downloaded newer image for java:8<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">d23bdf5b1b1b</span><br>Step 2/5 : COPY *.jar /app.jar<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">d4de8837ebf9</span><br>Step 3/5 : CMD [&quot;--server.port=8080&quot;]<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">Running <span class="hljs-keyword">in</span> e3abc66303f0</span><br>Removing intermediate container e3abc66303f0<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">131bb3917fea</span><br>Step 4/5 : EXPOSE 8080<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">Running <span class="hljs-keyword">in</span> fa2f25977db7</span><br>Removing intermediate container fa2f25977db7<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">d98147377951</span><br>Step 5/5 : ENTRYPOINT [&quot;java&quot;, &quot;-jar&quot;, &quot;/app.jar&quot;]<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">Running <span class="hljs-keyword">in</span> e1885e23773b</span><br>Removing intermediate container e1885e23773b<br><span class="hljs-meta prompt_"> ---&gt; </span><span class="language-bash">afb6b5f28a32</span><br>Successfully built afb6b5f28a32<br>Successfully tagged xiaofan666:latest<br><span class="hljs-meta prompt_"> </span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">查看镜像</span><br>[root@iZ2zeg4ytp0whqtmxbsqiiZ idea]# docker images<br>REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE<br>xiaofan666          latest              afb6b5f28a32        14 seconds ago      660MB<br>tomcat              latest              2ae23eb477aa        8 days ago          647MB<br>redis               5.0.9-alpine3.11    3661c84ee9d0        3 months ago        29.8MB<br>java                8                   d23bdf5b1b1b        3 years ago         643MB<br><span class="hljs-meta prompt_"> </span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">运行容器</span><br>[root@iZ2zeg4ytp0whqtmxbsqiiZ idea]# docker run -d -P --name xiaofan-springboot-web xiaofan666<br>fd9a353a80bfd61f6930c16cd92204532bfd734e003f3f9983b5128a27b0375e<br><span class="hljs-meta prompt_"># </span><span class="language-bash">查看运行起来的容器端口（因为我们启动的时候没有指定）</span><br>[root@iZ2zeg4ytp0whqtmxbsqiiZ idea]# docker ps<br>CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                     NAMES<br>fd9a353a80bf        xiaofan666          &quot;java -jar /app.jar …&quot;   9 seconds ago       Up 8 seconds        0.0.0.0:32779-&gt;8080/tcp   xiaofan-springboot-web<br><span class="hljs-meta prompt_"># </span><span class="language-bash">本地访问1</span><br>[root@iZ2zeg4ytp0whqtmxbsqiiZ idea]# curl localhost:32779<br>&#123;&quot;timestamp&quot;:&quot;2020-08-14T09:42:57.371+00:00&quot;,&quot;status&quot;:404,&quot;error&quot;:&quot;Not Found&quot;,&quot;message&quot;:&quot;&quot;,&quot;path&quot;:&quot;/&quot;&#125;<br><span class="hljs-meta prompt_"># </span><span class="language-bash">本地访问2</span><br>[root@iZ2zeg4ytp0whqtmxbsqiiZ idea]# [root@iZ2zeg4ytp0whqtmxbsqiiZ idea]# curl localhost:32779/hello<br>hello, xiaofan<br><span class="hljs-meta prompt_"># </span><span class="language-bash">远程访问</span><br><br><br></code></pre></td></tr></table></figure>

<h3 id="12-Docker-Compose"><a href="#12-Docker-Compose" class="headerlink" title="12 Docker Compose"></a>12 Docker Compose</h3><h4 id="12-1-简介"><a href="#12-1-简介" class="headerlink" title="12.1: 简介"></a>12.1: 简介</h4><p> 假设有100个微服务,那使用dockerFile构建,docker build,docker run等进行操作,相当麻烦,使用Docker Compose来进行容器间高效的管理,定义运行多个容器等</p>
<p> 12.2: 使用步骤</p>
<figure class="highlight ldif"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ldif"><span class="hljs-attribute">1</span>: dockerFile定义应用的运行环境,保证我们项目在任何地方都可以运行<br><span class="hljs-attribute">2</span>: docker-compose.yaml:定义服务并将他们写入yaml配置中,一次启动多个服务<br><span class="hljs-attribute">3</span>: docker compose up 启动项目<br></code></pre></td></tr></table></figure>
            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/%E5%AE%B9%E5%99%A8%E8%99%9A%E6%8B%9F%E5%8C%96/">容器虚拟化</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/07/27/CICD/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">CICD</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/07/27/JUC%E5%B9%B6%E5%8F%91%E8%AF%A6%E8%A7%A3/">
                        <span class="hidden-mobile">JUC并发详解</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <i class="iconfont icon-love"></i>lier 
  </div>
  

  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.0/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js" ></script>






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    (function () {
      var path = "/local-search.xml";
      $('#local-search-input').on('click', function() {
        searchFunc(path, 'local-search-input', 'local-search-result');
      });
      $('#modalSearch').on('shown.bs.modal', function() {
        $('#local-search-input').focus();
      });
    })()
  </script>















<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
