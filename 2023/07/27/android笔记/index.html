

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/cute_icon.png">
  <link rel="icon" href="/img/cute_icon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="lier">
  <meta name="keywords" content="">
  
  <title>android笔记 - Blog</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.4.0/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.9","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}}};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>lier的博客</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/background.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="android笔记">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2023-07-27 11:09" pubdate>
        2023年7月27日 上午
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      12.6k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      177
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">android笔记</h1>
            
            <div class="markdown-body">
              <h1 id="Android开发"><a href="#Android开发" class="headerlink" title="Android开发"></a>Android开发</h1><h3 id="1：架构说明"><a href="#1：架构说明" class="headerlink" title="1：架构说明"></a>1：架构说明</h3><p><a target="_blank" rel="noopener" href="https://developer.android.google.cn/static/guide/platform/images/android-stack_2x.png?hl=zh-cn"><img src="https://developer.android.google.cn/static/guide/platform/images/android-stack_2x.png?hl=zh-cn" srcset="/img/loading.gif" lazyload alt="Snipaste_2023-06-27_14-52-08"></a></p>
<h4 id="1-1：Linux-内核"><a href="#1-1：Linux-内核" class="headerlink" title="1.1：Linux 内核"></a><strong>1.1：Linux 内核</strong></h4><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-keyword">Android </span>平台的基础是 Linux 内核。例如，<span class="hljs-keyword">Android </span>Runtime (ART) 依靠 Linux 内核来执行底层功能，例如线程和底层内存管理。<br>使用 Linux 内核可让 <span class="hljs-keyword">Android </span>利用主要安全功能，并且允许设备制造商为著名的内核开发硬件驱动程序<br><br>MIPSASM<br></code></pre></td></tr></table></figure>

<h4 id="1-2：硬件抽象层-HAL"><a href="#1-2：硬件抽象层-HAL" class="headerlink" title="1.2：硬件抽象层 (HAL)"></a><strong>1.2：硬件抽象层 (HAL)</strong></h4><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">硬件抽象层 (HAL)提供标准界面，向更高级别的 <span class="hljs-keyword">Java </span>API 框架显示设备硬件功能。HAL 包含多个库模块，其中每个模块都为特定类型的硬件组件实现一个界面，例如相机或蓝牙模块。当框架 API 要求访问设备硬件时，<span class="hljs-keyword">Android </span>系统将为该硬件组件加载库模块<br><br>MIPSASM<br></code></pre></td></tr></table></figure>

<h4 id="1-3：Android-Runtime"><a href="#1-3：Android-Runtime" class="headerlink" title="1.3：Android Runtime"></a><strong>1.3：Android Runtime</strong></h4><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">包括Dalvik虚拟机和Java核心库，关于Dalvik虚拟机和JVM的区别：Dalvik是基于寄存器的，JVM是基于栈的。JVM运行<span class="hljs-string">.class</span>文件，每个<span class="hljs-string">.class</span>文件对应一个类；Dalvik虚拟机将<span class="hljs-string">.class</span>文件转为<span class="hljs-string">.dex</span>文件，只有一个<span class="hljs-string">.dex</span>文件，包含了所有的类，并且通过性能优化转为<span class="hljs-string">.odex</span>文件。基于寄存器的虚拟机运行速度更快，文件更小，效率更高，适合移动端。另外Dalvik虚拟机需要更多的指令空间<br><br>JBOSS-CLI<br></code></pre></td></tr></table></figure>



<h4 id="1-4：原生-C-C-库"><a href="#1-4：原生-C-C-库" class="headerlink" title="1.4：原生 C&#x2F;C++ 库"></a><strong>1.4：原生 C&#x2F;C++ 库</strong></h4><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">许多核心 <span class="hljs-keyword">Android </span>系统组件和服务（例如 ART 和 HAL）构建自原生代码，需要以 C 和 C++ 编写的原生库。<span class="hljs-keyword">Android </span>平台提供 <span class="hljs-keyword">Java </span>框架 API 以向应用显示其中部分原生库的功能<br><br>MIPSASM<br></code></pre></td></tr></table></figure>

<h4 id="1-5：Java-API-框架"><a href="#1-5：Java-API-框架" class="headerlink" title="1.5：Java API 框架"></a><strong>1.5：Java API 框架</strong></h4><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">您可通过以 <span class="hljs-keyword">Java </span>语言编写的 API 使用 <span class="hljs-keyword">Android </span>OS 的整个功能集。这些 API 形成创建 <span class="hljs-keyword">Android </span>应用所需的构建块，它们可简化核心模块化系统组件和服务的重复使用<br><br>MIPSASM<br></code></pre></td></tr></table></figure>

<h4 id="1-6：系统应用"><a href="#1-6：系统应用" class="headerlink" title="1.6：系统应用"></a><strong>1.6：系统应用</strong></h4><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-keyword">Android </span>随附一套用于电子邮件、短信、日历、互联网浏览和联系人等的核心应用。平台随附的应用与用户可以选择安装的应用一样，没有特殊状态<br><br>MIPSASM<br></code></pre></td></tr></table></figure>

<h3 id="2：activity详解"><a href="#2：activity详解" class="headerlink" title="2：activity详解"></a>2：activity详解</h3><h4 id="2-1：概念"><a href="#2-1：概念" class="headerlink" title="2.1：概念"></a>2.1：概念</h4><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">Activity</span> 是一个应用组件，用户可与其提供的屏幕进行交互，以执行拨打电话、拍摄照片、发送电子邮件或查看地图等操作。每个 Activity 都会获得一个用于绘制其用户界面的窗口。窗口通常会充满屏幕，但也可小于屏幕并浮动在其他窗口之上。<br><br></code></pre></td></tr></table></figure>

<h4 id="2-2：生命周期"><a href="#2-2：生命周期" class="headerlink" title="2.2：生命周期"></a>2.2：生命周期</h4><p><strong>1：activity的四种状态</strong></p>
<table>
<thead>
<tr>
<th><strong>Active&#x2F;Running:</strong></th>
<th align="left">Activity处于活动状态，此时Activity处于栈顶，是可见状态，可与用户进行交互</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Paused</strong></td>
<td align="left">当Activity失去焦点时，或被一个新的非全屏的Activity，或被一个透明的Activity放置在栈顶时，Activity就转化为Paused状态。但我们需要明白，此时Activity只是失去了与用户交互的能力，其所有的状态信息及其成员变量都还存在，只有在系统内存紧张的情况下，才有可能被系统回收掉</td>
</tr>
<tr>
<td><strong>Stopped</strong></td>
<td align="left">当一个Activity被另一个Activity完全覆盖时，被覆盖的Activity就会进入Stopped状态，此时它不再可见，但是跟Paused状态一样保持着其所有状态信息及其成员变量</td>
</tr>
<tr>
<td><strong>Killed</strong></td>
<td align="left">当Activity被系统回收掉时，Activity就处于Killed状态。 Activity会在以上四种形态中相互切换，至于如何切换</td>
</tr>
</tbody></table>
<p><strong>2：activity的生命周期</strong></p>
<p><a target="_blank" rel="noopener" href="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/5/23/16ae494667431341~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.image"><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/5/23/16ae494667431341~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.image" srcset="/img/loading.gif" lazyload alt="img"></a></p>
<p><strong>「onCreate()」</strong>：你必须实现此回调，它会在系统创建你的 Activity 时触发。你的实现应 该初始化Activity的基本组件。</p>
<p><strong>「onStart()」</strong>：此回调包含 Activity 进入前台与用户进行互动之前的最后准备工作。到了这一步用户可见不可交互。</p>
<p><strong>「onResume()」</strong>：此时，该Activity位于Activity堆栈的顶部，并会捕获所有用户输入。应用的大部分核心功能都是在onResume()方法中实现的。到了这一步用户可见可交互。</p>
<p><strong>「onPause()」</strong>：当用户点按”返回”或”最近使用的应用”按钮时，Activity失去焦点并进入”已暂停”状态时，系统就会调用onPause()。到这一步用户可见不可交互。系统会停止动画等消耗CPU的操作。</p>
<p><strong>「onStop()」</strong>：到了这一步用户不可见。停止动画和刷新UI等。</p>
<p><strong>「onRestart()」</strong>：当处于”onStop()”状态的Activity即将重启时，系统就会调用此回调。onRestart()会从Activity停止时的状态恢复Activity至运行状态。</p>
<p><strong>「onDestroy()」</strong>：这是Activity最后一个方法。可以用isFinishing()来判断它，如果有dialog在运转，要在这个界面将dialog给cancel掉，不然抛异常。</p>
<h4 id="2-3：自定义activity实现HelloWorld"><a href="#2-3：自定义activity实现HelloWorld" class="headerlink" title="2.3：自定义activity实现HelloWorld"></a><strong>2.3：自定义activity实现HelloWorld</strong></h4><p><strong>在java目录中新建自定义Activity</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Activity</span> &#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Bundle savedInstanceState)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);<br>        setContentView(R.layout.layout_my_activity);<br>    &#125;<br>&#125;<br><br><br></code></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/x.png"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/x.png" srcset="/img/loading.gif" lazyload alt="x"></a></p>
<p><strong>在res目录新建layout目录并添加xml文件</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs XML"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span></span><br><span class="hljs-tag">    <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;match_parent&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;match_parent&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:orientation</span>=<span class="hljs-string">&quot;vertical&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:gravity</span>=<span class="hljs-string">&quot;center&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">TextView</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:gravity</span>=<span class="hljs-string">&quot;center&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;match_parent&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;wrap_content&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:text</span>=<span class="hljs-string">&quot; Hello World!&quot;</span> /&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span><br><br><br></code></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/Snipaste_2023-07-06_15-55-32.png"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/Snipaste_2023-07-06_15-55-32.png" srcset="/img/loading.gif" lazyload alt="Snipaste_2023-07-06_15-55-32"></a></p>
<p>Snipaste_2023-07-06_15-55-32</p>
<p><strong>在manifests目中的xml文件中注册activity</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs XML"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">manifest</span> <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">package</span>=<span class="hljs-string">&quot;com.lier.activity&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">application</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:allowBackup</span>=<span class="hljs-string">&quot;true&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:icon</span>=<span class="hljs-string">&quot;@mipmap/ic_launcher&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:label</span>=<span class="hljs-string">&quot;@string/app_name&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:roundIcon</span>=<span class="hljs-string">&quot;@mipmap/ic_launcher_round&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:supportsRtl</span>=<span class="hljs-string">&quot;true&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:theme</span>=<span class="hljs-string">&quot;@style/Theme.Activity&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">activity</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">&quot;.MyActivity&quot;</span> <span class="hljs-attr">android:exported</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">intent-filter</span>&gt;</span><br>                <br>                <span class="hljs-comment">&lt;!--&gt;表示该Activity为主Activity,首先进入该Activity&lt;/--&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">&quot;android.intent.action.MAIN&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">action</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">category</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">&quot;android.intent.category.LAUNCHER&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">category</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">intent-filter</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">activity</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">application</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">manifest</span>&gt;</span><br><br><br></code></pre></td></tr></table></figure>

<p>效果如图：</p>
<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/Snipaste_2023-07-06_15-59-04.png"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/Snipaste_2023-07-06_15-59-04.png" srcset="/img/loading.gif" lazyload alt="Snipaste_2023-07-06_15-59-04"></a></p>
<h4 id="2-4：activity启动"><a href="#2-4：activity启动" class="headerlink" title="2.4：activity启动"></a>2.4：activity启动</h4><p> activity启动由Intent实现，主要分为显示启动是隐式启动</p>
<h5 id="2-4-1-隐式启动"><a href="#2-4-1-隐式启动" class="headerlink" title="2.4.1: 隐式启动"></a>2.4.1: 隐式启动</h5><p> 只需知道其activity的action和category即可，无需知道其包名和类名</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-type">Intent</span> <span class="hljs-variable">intent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>();<br>intent.setAction(<span class="hljs-string">&quot;android.intent.action.SECOND_ACTIVITY&quot;</span>);<br>intent.addCategory(Intent.CATEGORY_DEFAULT);<br>startActivity(intent);<br><br><br></code></pre></td></tr></table></figure>

<h5 id="2-4-2：显式启动"><a href="#2-4-2：显式启动" class="headerlink" title="2.4.2：显式启动"></a>2.4.2：显式启动</h5><p> 根据类名或类名加包名启动（当类名或包名改动后，无法启动）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-type">Intent</span> <span class="hljs-variable">intent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>(FirstActivity.<span class="hljs-built_in">this</span>, SecondActivity.class)<br>    <br>intent.setClassName(getPackageName(),getPackageName()+<span class="hljs-string">&quot;.SecondActivity&quot;</span>);<br><br><br></code></pre></td></tr></table></figure>

<h5 id="2-4-3：任务栈"><a href="#2-4-3：任务栈" class="headerlink" title="2.4.3：任务栈"></a>2.4.3：任务栈</h5><p> Android 任务栈又称为 Task，它是一个栈类型的数据结构：先进后出。它用于存储我们的 Activity 组件</p>
<p> 打开和关闭一个activity都会添加和删除任务栈中的一个activity,安卓系统可以使用Task管理好每个activity,<strong>只有栈顶的activity可以与用户交互</strong></p>
<p> 应用程序退出后，只有当Task中的activity的清空后，才会销毁Task,当然Task也可以在后台运行，保存其中activity信息，当用户切回应用程序时，继续提供服务</p>
<p> 一个应用程序中，可能由多个Task,<strong>一个Task可以被一个activity独享，或者可以由多个来自不同app的activity,同一个App的activity也可以在不同的Task中</strong></p>
<h5 id="2-4-4：启动模式"><a href="#2-4-4：启动模式" class="headerlink" title="2.4.4：启动模式"></a>2.4.4：启动模式</h5><p> 开发应用程序时，需要在不同的activity中跳转，或者跳转到别的应用程序中可复用的activity, <strong>当我们跳转到前面已经开启的activity时，安卓系统就会默认新建一个activity并加入任务栈中，导致已经开启的activity不可复用</strong></p>
<p> <strong>standard模式</strong></p>
<p> 系统默认模式，每次启动activity，不管其存不存在都会创建一个新的实例</p>
<p> <strong>singleTop</strong></p>
<p> 在该模式下，如果栈顶Activity为我们要新建的Activity（目标Activity），那么就不会重复创建新的Activity。</p>
<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/20180606103740431"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/20180606103740431" srcset="/img/loading.gif" lazyload alt="img"></a></p>
<p> <strong>SingleTask</strong></p>
<p> 与singleTop模式相似，只不过singleTop模式是只是针对栈顶的元素，而singleTask模式下，如果task栈内存在目标Activity实例，则：</p>
<p> <strong>1.将task内的对应Activity实例之上的所有Activity弹出栈。</strong><br>​ <strong>2.将对应Activity置于栈顶，获得焦点。</strong></p>
<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/20180606105812988"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/20180606105812988" srcset="/img/loading.gif" lazyload alt="img"></a></p>
<p> <strong>SingleInstance</strong></p>
<p> 在该模式下，我们会为目标Activity分配一个新的affinity，并创建一个新的Task栈，将目标Activity放入新的Task，并让目标Activity获得焦点。新的Task有且只有这一个Activity实例。如果已经创建过目标Activity实例，则不会创建新的Task，而是将以前创建过的Activity唤醒（对应Task设为Foreground状态）</p>
<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/20180606111812956"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/20180606111812956" srcset="/img/loading.gif" lazyload alt="img"></a></p>
<p> <strong>使用方式</strong></p>
<ol>
<li><p>在 AndroidManifes.xml 中 ，找到声明 Activity 的位置，在 Actvity XML 属性 android:launchMode&#x3D;”standard”,其他模式（singleTop，singleTask，singleInstance） 声明</p>
<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/Snipaste_2023-07-06_18-26-26.png"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/Snipaste_2023-07-06_18-26-26.png" srcset="/img/loading.gif" lazyload alt="Snipaste_2023-07-06_18-26-26"></a></p>
</li>
<li><p>在代码中跳转 Activity 时，利用 Intent 指定 Flag 标志位来使用启动模式。示例代码如下：</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-type">Intent</span> <span class="hljs-variable">intent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>(<span class="hljs-built_in">this</span>, SecondActivity.class);<br>intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);<span class="hljs-comment">//Flag</span><br>startActivity(intent);<br><br>JAVA<br><span class="hljs-comment">//使用一个新的Task来启动Activity，但每个Activity都将在一个新的Task中。</span><br>Intent.FLAG_ACTIVITY_NEW_TASK   <br><span class="hljs-comment">//使用singleTop模式来启动一个Activity。  </span><br>Intent.FLAG_ACTIVITY_SINGLE_TOP  <br><span class="hljs-comment">//使用singleTask模式来启动一个Activity。</span><br>Intent.FLAG_ACTIVITY_CLEAR_TOP<br><span class="hljs-comment">//使用singleTask模式来启动一个Activity，使用这种方式启动Activity，当Activity启动其他Activity的时候，该Activity会被销毁，不入栈。  </span><br>Intent.FLAG_ACTIVITY_NO_HISTORY<br><span class="hljs-comment">//方式无法指定 SingleInstance 模式，SingleInstances 只能在 AndroidManifest.xml 中声明。</span><br>Intent.setFlags<br><br><br></code></pre></td></tr></table></figure>

<h3 id="3：Fragment详解"><a href="#3：Fragment详解" class="headerlink" title="3：Fragment详解"></a>3：Fragment详解</h3><h4 id="3-1：基本概念"><a href="#3-1：基本概念" class="headerlink" title="3.1：基本概念"></a>3.1：基本概念</h4><p> Fragment(片段)，依赖于activity,一个activity中可以有多个片段，可以在activity中动态添加删除，且Fragment有自己的生命周期，能够接受自己的输入事件</p>
<p> 即页面的一部分</p>
<p> 模块化：我们不必把所有代码全部写在Activity中，而是把代码写在各自的Fragment中。</p>
<p> 可重用：多个Activity可以重用一个Fragment。</p>
<p> 可适配：根据硬件的屏幕尺寸、屏幕方向，能够方便地实现不同的布局，这样用户体验更好</p>
<h4 id="3-2：Fragment生命周期"><a href="#3-2：Fragment生命周期" class="headerlink" title="3.2：Fragment生命周期"></a>3.2：Fragment生命周期</h4><p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/98a72b18702642d0a39b88b41f1e68d2.jpeg"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/98a72b18702642d0a39b88b41f1e68d2.jpeg" srcset="/img/loading.gif" lazyload alt="img"></a></p>
<h4 id="3-3：注册到activity"><a href="#3-3：注册到activity" class="headerlink" title="3.3：注册到activity"></a>3.3：注册到activity</h4><h5 id="3-3-1：静态注册"><a href="#3-3-1：静态注册" class="headerlink" title="3.3.1：静态注册"></a>3.3.1：静态注册</h5><p> 以标签的形式将fragment注册到指定的activity中，但后续不便于进行动态的相关操作</p>
<p> <strong>实例</strong></p>
<p> 创建Faragment类及其对应的布局xml文件</p>
<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/abd.png"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/abd.png" srcset="/img/loading.gif" lazyload alt="abd"></a></p>
<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/Snipaste_2023-07-07_11-46-40.png"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/Snipaste_2023-07-07_11-46-40.png" srcset="/img/loading.gif" lazyload alt="Snipaste_2023-07-07_11-46-22"></a></p>
<p> 使用标签将对应的fragment注册到activity中</p>
<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/Snipaste_2023-07-07_11-47-15.png"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/Snipaste_2023-07-07_11-47-15.png" srcset="/img/loading.gif" lazyload alt="Snipaste_2023-07-07_11-47-15"></a></p>
<h5 id="3-3-2：动态注册"><a href="#3-3-2：动态注册" class="headerlink" title="3.3.2：动态注册"></a>3.3.2：动态注册</h5><p> 通过java代码将fragment 从已存在的activity中注册&#x2F;删除&#x2F;替换</p>
<p> <strong>动态注册常用的类及方法</strong></p>
<table>
<thead>
<tr>
<th>FragmentManager</th>
<th>用来管理Activity中的fragment,app包中使用getFragmentManager() v4包中getSupportFragmentManager</th>
</tr>
</thead>
<tbody><tr>
<td>FragmentTransaction</td>
<td>事务,用来添加，移除，替换fragment,FragmentTransaction transaction &#x3D; fm.benginTransatcion()</td>
</tr>
<tr>
<td><strong>transaction.add()</strong></td>
<td>往Activity中添加一个Fragment</td>
</tr>
<tr>
<td><strong>transaction.remove()</strong></td>
<td>从Activity中移除一个Fragment，如果被移除的Fragment没有添加到回退栈，这个Fragment实例将会被销毁。</td>
</tr>
<tr>
<td>transaction.replace()</td>
<td>使用另一个Fragment替换当前的，实际上就是remove()然后add()的合体</td>
</tr>
<tr>
<td>transaction.hide()</td>
<td>隐藏当前的Fragment，仅仅是设为不可见，并不会销毁</td>
</tr>
<tr>
<td>transaction.show()</td>
<td>显示之前隐藏的Fragment</td>
</tr>
<tr>
<td>transaction.commit()</td>
<td>提交一个事务</td>
</tr>
</tbody></table>
<p> <strong>实例</strong></p>
<p> 编写两个fragment</p>
<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/Snipaste_2023-07-07_15-48-38.png"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/Snipaste_2023-07-07_15-48-38.png" srcset="/img/loading.gif" lazyload alt="Snipaste_2023-07-07_15-48-38"></a></p>
<p> 编写activity中代码，动态添加，隐藏，显示fragment</p>
<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/QQ%E6%88%AA%E5%9B%BE20230707155032.png"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/QQ%E6%88%AA%E5%9B%BE20230707155032.png" srcset="/img/loading.gif" lazyload alt="QQ截图20230707155032"></a></p>
<p>最终实现效果，点击按钮实现切换不同的fragment</p>
<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/test.gif"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/test.gif" srcset="/img/loading.gif" lazyload alt="test"></a></p>
<h4 id="3-4：Fragment通信"><a href="#3-4：Fragment通信" class="headerlink" title="3.4：Fragment通信"></a>3.4：Fragment通信</h4><h5 id="3-4-1：使用activity通信"><a href="#3-4-1：使用activity通信" class="headerlink" title="3.4.1：使用activity通信"></a>3.4.1：使用activity通信</h5><ul>
<li>在Fragment中，可以通过<code>getActivity()</code>方法获取关联的Activity实例，然后调用Activity的公共方法来进行通信。</li>
<li>在Activity中，可以定义接口或回调方法，并在Fragment中实现接口或传递回调对象，在需要通信的地方调用相应的方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-comment">//添加时指定对应Fragment的tag</span><br><span class="hljs-type">Fragment</span> <span class="hljs-variable">f1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Fragment1</span>();<br><span class="hljs-type">Fragment2</span> <span class="hljs-variable">f2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Fragment2</span>();<br><span class="hljs-comment">//指定具体fragment的tag,后续可以使用findFragmentByTag找到指定的fragment</span><br>transaction.add(f1,<span class="hljs-string">&quot;f1&quot;</span>);<br>transaction.add(f2,<span class="hljs-string">&quot;f2&quot;</span>);<br><br><span class="hljs-comment">//在其他的Fragment中使用findFragmentByTag(String tag)方法获取的指定的Fragment进行通信</span><br><span class="hljs-type">RightFragment</span> <span class="hljs-variable">rightFragment</span> <span class="hljs-operator">=</span> (RightFragment) <span class="hljs-built_in">this</span>.getActivity().getSupportFragmentManager().findFragmentByTag(<span class="hljs-string">&quot;right&quot;</span>);<br><br><br></code></pre></td></tr></table></figure>

<h5 id="3-4-2：Bundle通信"><a href="#3-4-2：Bundle通信" class="headerlink" title="3.4.2：Bundle通信"></a>3.4.2：Bundle通信</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FragmentA</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Fragment</span> &#123;<br><br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendDataToFragmentB</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">data</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Hello Fragment B!&quot;</span>;<br>        <br>        <span class="hljs-comment">// 创建Bundle对象</span><br>        <span class="hljs-type">Bundle</span> <span class="hljs-variable">bundle</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Bundle</span>();<br>        <br>        <span class="hljs-comment">// 将数据放入Bundle中</span><br>        bundle.putString(<span class="hljs-string">&quot;data&quot;</span>, data);<br>        <br>        <span class="hljs-comment">// 获取FragmentManager，并开启一个事务</span><br>        <span class="hljs-type">FragmentManager</span> <span class="hljs-variable">fragmentManager</span> <span class="hljs-operator">=</span> getParentFragmentManager();<br>        <span class="hljs-type">FragmentTransaction</span> <span class="hljs-variable">fragmentTransaction</span> <span class="hljs-operator">=</span> 			     fragmentManager.beginTransaction();<br>        <br>        <span class="hljs-comment">// 创建FragmentB实例</span><br>        <span class="hljs-type">FragmentB</span> <span class="hljs-variable">fragmentB</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FragmentB</span>();<br>     <br>        <span class="hljs-comment">// 将Bundle对象传递给FragmentB</span><br>        fragmentB.setArguments(bundle);<br><br>        <span class="hljs-comment">// 替换当前的Fragment为FragmentB</span><br>        fragmentTransaction.replace(R.id.fragment_container, fragmentB);<br>        <br>        <span class="hljs-comment">// 提交事务</span><br>        fragmentTransaction.commit();<br>    &#125;<br><br>    <span class="hljs-comment">// ... 省略其他代码 ...</span><br>&#125;<br></code></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FragmentB</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Fragment</span> &#123;<br><br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> View <span class="hljs-title function_">onCreateView</span><span class="hljs-params">(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState)</span> &#123;<br>        <span class="hljs-type">View</span> <span class="hljs-variable">view</span> <span class="hljs-operator">=</span> inflater.inflate(R.layout.fragment_b, container, <span class="hljs-literal">false</span>);<br><br>        <span class="hljs-comment">// 获取传递过来的Bundle</span><br>        <span class="hljs-type">Bundle</span> <span class="hljs-variable">bundle</span> <span class="hljs-operator">=</span> getArguments();<br><br>        <span class="hljs-keyword">if</span> (bundle != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-comment">// 从Bundle中取出数据</span><br>            <span class="hljs-type">String</span> <span class="hljs-variable">data</span> <span class="hljs-operator">=</span> bundle.getString(<span class="hljs-string">&quot;data&quot;</span>);<br><br>            <span class="hljs-comment">// 在这里展示数据</span><br>            <span class="hljs-comment">// 例如，将数据设置给TextView</span><br>            <span class="hljs-type">TextView</span> <span class="hljs-variable">textView</span> <span class="hljs-operator">=</span> view.findViewById(R.id.text_view);<br>            textView.setText(data);<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> view;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<h5 id="3-4-3：EventBus通信"><a href="#3-4-3：EventBus通信" class="headerlink" title="3.4.3：EventBus通信"></a>3.4.3：EventBus通信</h5><p>EventBus是一个开源的Android事件总线库，它简化了组件之间的通信。EventBus使用观察者模式，组件可以发布事件，同时其他组件也可以订阅和接收这些事件</p>
<p>​	<strong>使用步骤：</strong></p>
<p>​	1：引入依赖</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs clean">dependencies &#123;<br>    <span class="hljs-keyword">implementation</span> <span class="hljs-string">&#x27;org.greenrobot:eventbus:3.2.0&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>​	2：创建事件类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MessageEvent</span> &#123;<br>    <span class="hljs-keyword">private</span> String message;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">MessageEvent</span><span class="hljs-params">(String message)</span> &#123;<br>        <span class="hljs-built_in">this</span>.message = message;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getMessage</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> message;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>​	3：注册和取消注册</p>
<p>在每个需要接收事件的组件中，都需要在合适的生命周期方法中注册和取消注册EventBus</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onStart</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-built_in">super</span>.onStart();<br>    EventBus.getDefault().register(<span class="hljs-built_in">this</span>);<br>&#125;<br><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onStop</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-built_in">super</span>.onStop();<br>    EventBus.getDefault().unregister(<span class="hljs-built_in">this</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>​	4：发消息</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">String message = <span class="hljs-string">&quot;Hello EventBus!&quot;</span>;<br><span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">EventBus</span>.</span></span>get<span class="hljs-constructor">Default()</span>.post(<span class="hljs-keyword">new</span> <span class="hljs-constructor">MessageEvent(<span class="hljs-params">message</span>)</span>);<br></code></pre></td></tr></table></figure>

<p>​	5：接受消息</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Subscribe</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onMessageEvent</span><span class="hljs-params">(MessageEvent event)</span> &#123;<br>    <span class="hljs-type">String</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> event.getMessage();<br>    <span class="hljs-comment">// 处理接收到的消息</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>后续可以使用广播Boardcast通信</p>
<h3 id="4：service详解"><a href="#4：service详解" class="headerlink" title="4：service详解"></a>4：service详解</h3><h4 id="4-1：基本介绍"><a href="#4-1：基本介绍" class="headerlink" title="4.1：基本介绍"></a>4.1：基本介绍</h4><p> service为安卓的四大组件之一，是一个没有用户界面可以在后台无限期运行的组件</p>
<h4 id="4-2：启动方式"><a href="#4-2：启动方式" class="headerlink" title="4.2：启动方式"></a>4.2：启动方式</h4><h5 id="4-2-1：startService"><a href="#4-2-1：startService" class="headerlink" title="4.2.1：startService"></a>4.2.1：startService</h5><p> 通过该方式启动Service，访问者与Service之间没有关联，即使访问者退出了，Service也仍然运行</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-comment">//启动服务</span><br><span class="hljs-type">Intent</span> <span class="hljs-variable">intent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>(Activity.<span class="hljs-built_in">this</span>,Service.class)<br>startService(intent)<br><br><span class="hljs-comment">//停止服务</span><br>stopService(intent)<br><br><br></code></pre></td></tr></table></figure>

<p> <strong>startService实例</strong></p>
<p> 1：service类的创建及声明</p>
<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/Snipaste_2023-07-10_10-26-21.png"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/Snipaste_2023-07-10_10-26-21.png" srcset="/img/loading.gif" lazyload alt="Snipaste_2023-07-10_10-26-21"></a></p>
<p> 2：activity的页面绘制和类声明</p>
<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/071010295792_0Snipaste_2023-07-10_10-28-39.png"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/071010295792_0Snipaste_2023-07-10_10-28-39.png" srcset="/img/loading.gif" lazyload alt="071010295792_0Snipaste_2023-07-10_10-28-39"></a></p>
<p> 3：结果</p>
<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/071010293115_0Snipaste_2023-07-10_10-29-01.png"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/071010293115_0Snipaste_2023-07-10_10-29-01.png" srcset="/img/loading.gif" lazyload alt="071010293115_0Snipaste_2023-07-10_10-29-01"></a></p>
<h5 id="4-2-1：bindService"><a href="#4-2-1：bindService" class="headerlink" title="4.2.1：bindService"></a>4.2.1：bindService</h5><p> 1.bindService启动的服务和调用者之间是典型的<strong>client-server</strong>模式。调用者是client，service则是server 端。service只有一个，但绑定到service上面的client可以有一个或很多个。这里所提到的client指的是组件，比 如某个Activity。<br>​ 2.<strong>client可以通过IBinder接口获取Service实例</strong>，从而实现在client端直接调用Service中的方法以实现灵 活交互，这在通过startService方法启动中是无法实现的。<br>​ 3.bindService启动服务的生命周期与其绑定的client息息相关。当client销毁时，client会自动与Service解 除绑定。当然，client也可以明确调用Context的unbindService()方法与Service解除绑定。当没有任何client与 Service绑定时，Service会自行销毁</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs JAVA">bindService(Intent service, ServiceConnection conn,<span class="hljs-type">int</span> flags)<br>    <br><span class="hljs-comment">// Intent：就是你要绑定的服务，需要明确的声明。</span><br><span class="hljs-comment">// ServiceConnection：一个接口，包含两个回调onServiceConnected和onServiceDisconnected</span><br><span class="hljs-comment">// flags：一般选用BIND_AUTO_CREATE，下面的分析都是基于这个flag</span><br><span class="hljs-comment">// BIND_AUTO_CREATE：当bindService时，该服务如果不存在则自动创建该服务，Service生命周期：onCreate--&gt;onBind；如果服务存在，只会调用onBind;</span><br><br></code></pre></td></tr></table></figure>

<p> <strong>bindService实例</strong></p>
<p> <strong>1. Service</strong></p>
<p> 1.在Service的onBind()方法中返回IBinder类型的实例。<br>2.onBInd()方法返回的IBinder的实例需要能够返回Service实例本身。通常,最简单的方法就是在service 中创建binder的内部类，加入类似getService()的方法返回Service</p>
<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/Snipaste_2023-07-10_16-21-20.png"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/Snipaste_2023-07-10_16-21-20.png" srcset="/img/loading.gif" lazyload alt="Snipaste_2023-07-10_16-21-20"></a></p>
<p>Snipaste_2023-07-10_16-21-20</p>
<p> <strong>2：client(这里使用activity)</strong></p>
<p> 1.创建<strong>ServiceConnection</strong>类型实例，并重写**onServiceConnected()**方法和onServiceDisconnected() 方法。<br>​ 2.当执行到onServiceConnected回调时，可通过IBinder实例得到Service实例对象，这样可实现client 与Service的连接。<br>​ 3.onServiceDisconnected回调被执行时，表示client与Service断开连接，在此可以写一些断开连接后需 要做的处理。只有断开不成功的时候会被执行</p>
<p> <strong>ActivityA和ActivityB代码类似</strong></p>
<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/071016293151_0QQ%E6%88%AA%E5%9B%BE20230710162815.png"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/071016293151_0QQ%E6%88%AA%E5%9B%BE20230710162815.png" srcset="/img/loading.gif" lazyload alt="071016293151_0QQ截图20230710162815"></a></p>
<p>071016293151_0QQ截图20230710162815</p>
<p> <strong>实现效果</strong></p>
<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/071016332657_0Snipaste_2023-07-10_16-32-12.png"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/071016332657_0Snipaste_2023-07-10_16-32-12.png" srcset="/img/loading.gif" lazyload alt="071016332657_0Snipaste_2023-07-10_16-32-12"></a></p>
<p>071016332657_0Snipaste_2023-07-10_16-32-12</p>
<p> <strong>结果讲述</strong></p>
<p> <strong>1.点击ActivityA的bindService按钮</strong><br>第一次调用bindService会实例化TestTwoService，然后执行其onBind()方法，得到IBinder类型的实例，将其作为参数传入ActivityA的ServiceConnection的onServiceConnected方法中，标志着ActivityA和Service建立了绑定</p>
<p> <strong>2.点击ActivityB中的bindService按钮</strong><br>​ 由于TestTwoService已处于运行状态，所以再次调用bindService不会重新创建它的实例，所以也不会执行TestTwoService的onCreate()方法和onBind()方法。ActivityB与ActivityA共享IBinder实例。此时有两个client与TestTwoService绑定。</p>
<p> <strong>3.点击ActivityB中的unbindService按钮</strong><br>ActivityB与TestTwoService解除了绑定，当没有任何client与Service绑定时，才会执行Service的onUnbind()方法。此时，<strong>ActivityA还在绑定连接中，所以不会执行Service的解绑方法</strong>。</p>
<p> <strong>4.点击ActivityA中的unbindService按钮</strong><br>ActivityA执行unbindService之后，ActivityA与TestTwoService就解除绑定了，这样就没有client与TestTwoService绑定，这时候Android会销毁TestTwoService，在销毁前会先执行TestTwoService的onUnbind()方法，然后才会执行其onDestroy()方法，这样TestService就销毁了。</p>
<h4 id="4-3：Service生命周期"><a href="#4-3：Service生命周期" class="headerlink" title="4.3：Service生命周期"></a>4.3：Service生命周期</h4><p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/3ec6534aeaecba1eb2c6ba09f1abe6bb.png"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/3ec6534aeaecba1eb2c6ba09f1abe6bb.png" srcset="/img/loading.gif" lazyload alt="img"></a></p>
<h3 id="5：BroadcastReceiver详解"><a href="#5：BroadcastReceiver详解" class="headerlink" title="5：BroadcastReceiver详解"></a>5：BroadcastReceiver详解</h3><h4 id="5-1：基本介绍"><a href="#5-1：基本介绍" class="headerlink" title="5.1：基本介绍"></a>5.1：基本介绍</h4><p> 在 Android 系统中，广播（Broadcast）是在组件之间传播数据的一种机制，这些组件可以位于不同的进程中，起到进程间通信的作用</p>
<p><strong>BroadcastReceiver</strong> 是对发送出来的 <strong>Broadcast</strong> 进行过滤、接受和响应的组件。</p>
<h4 id="5-2：作用"><a href="#5-2：作用" class="headerlink" title="5.2：作用"></a>5.2：作用</h4><ul>
<li><p>用于监听 &#x2F; 接收 应用发出的广播消息，并做出响应</p>
</li>
<li><p>应用场景<br>a. 不同组件之间通信（包括应用内 &#x2F; 不同应用之间）</p>
<p>b. 与 <code>Android</code> 系统在特定情况下的通信</p>
<blockquote>
<p>如当电话呼入时、网络可用时</p>
</blockquote>
<p>c. 多线程通信</p>
</li>
</ul>
<h4 id="5-3：怎么用"><a href="#5-3：怎么用" class="headerlink" title="5.3：怎么用"></a>5.3：怎么用</h4><h5 id="5-3-1：静态注册"><a href="#5-3-1：静态注册" class="headerlink" title="5.3.1：静态注册"></a>5.3.1：静态注册</h5><p> 即在AndroidManifest.xml文件中注册，android 8 (api26) 以后Google官方对静态注册方式进行限制</p>
<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/071109180390_0Snipaste_2023-07-11_09-17-27.png"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/071109180390_0Snipaste_2023-07-11_09-17-27.png" srcset="/img/loading.gif" lazyload alt="071109180390_0Snipaste_2023-07-11_09-17-27"></a></p>
<h5 id="5-3-2：动态注册"><a href="#5-3-2：动态注册" class="headerlink" title="5.3.2：动态注册"></a>5.3.2：动态注册</h5><p> 动态注册即在代码中注册，我们一般在onResume里面注册。<strong>通过IntentFileter这个类包装Receiver然后通过registerReceiver去注册</strong></p>
<p> <strong>动态广播在onResume中注册，在onPause中销毁，有注册必须有注册，不然可能造成内存泄漏</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">View</span>.OnClickListener&#123;<br><br>    <span class="hljs-keyword">private</span> DynamicBroadcastReceive dynamicBroadcastReceive;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);<br>        setContentView(R.layout.activity_main);<br><br>        findViewById(R.id.send).setOnClickListener(<span class="hljs-built_in">this</span>);<br>        findViewById(R.id.dynamic).setOnClickListener(<span class="hljs-built_in">this</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onResume</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">//动态注册</span><br>        <span class="hljs-built_in">super</span>.onResume();<br>        <span class="hljs-type">IntentFilter</span> <span class="hljs-variable">intentFilter</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IntentFilter</span>();<br>        intentFilter.addAction(<span class="hljs-string">&quot;com.lier.dynamic&quot;</span>);<br>        dynamicBroadcastReceive = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DynamicBroadcastReceive</span>();<br><br>        registerReceiver(dynamicBroadcastReceive, intentFilter);<br><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onPause</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-built_in">super</span>.onPause();<br>        <span class="hljs-comment">//注销</span><br>        unregisterReceiver(dynamicBroadcastReceive);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onClick</span><span class="hljs-params">(View view)</span> &#123;<br>        <span class="hljs-comment">//静态注册消息发送</span><br>        <span class="hljs-keyword">if</span>(view.getId() == R.id.send)&#123;<br>            <span class="hljs-type">Intent</span> <span class="hljs-variable">intent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>(<span class="hljs-string">&quot;android.intent.action.SEND&quot;</span>);<br>            intent.putExtra(<span class="hljs-string">&quot;msg&quot;</span>,<span class="hljs-string">&quot;hello world&quot;</span>);<br>            sendBroadcast(intent);<br>        &#125;<br><br>        <span class="hljs-comment">//动态消息发送</span><br>        <span class="hljs-keyword">if</span>(view.getId() == R.id.dynamic)&#123;<br>            <span class="hljs-type">Intent</span> <span class="hljs-variable">intent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>();<br>            intent.setAction(<span class="hljs-string">&quot;com.lier.dynamic&quot;</span>);<br>            intent.putExtra(<span class="hljs-string">&quot;str&quot;</span>,<span class="hljs-string">&quot;hello dynamic&quot;</span>);<br>            sendBroadcast(intent);<br>        &#125;<br>    &#125;<br>&#125;<br><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DynamicBroadcastReceive</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BroadcastReceiver</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onReceive</span><span class="hljs-params">(Context context, Intent intent)</span> &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">str</span> <span class="hljs-operator">=</span> intent.getStringExtra(<span class="hljs-string">&quot;str&quot;</span>);<br>        Log.i(getClass().getName(),<span class="hljs-string">&quot;接受到消息 = &quot;</span> + str);<br>    &#125;<br>&#125;<br><br><br></code></pre></td></tr></table></figure>

<h5 id="5-3-3：有序广播"><a href="#5-3-3：有序广播" class="headerlink" title="5.3.3：有序广播"></a>5.3.3：有序广播</h5><p> <strong>有序广播通过sendOrderedBroadcast发送，而接受者Receiver的Action是同一个，只不过他们通过 priority属性进行优先级的判定</strong>。priority越大优先级越高，优先级最高的会第一个拦截广播并处理，然后 才会往下传递.</p>
<p> <strong>创建三个Receiver</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderReceiver1</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BroadcastReceiver</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onReceive</span><span class="hljs-params">(Context context, Intent intent)</span> &#123;<br><br>        <span class="hljs-type">String</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> intent.getStringExtra(<span class="hljs-string">&quot;order&quot;</span>);<br>        Log.i(getClass().getName(),<span class="hljs-string">&quot;msg = &quot;</span> + order);<br><br>        <span class="hljs-type">Bundle</span> <span class="hljs-variable">bundle</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Bundle</span>();<br>        bundle.putString(<span class="hljs-string">&quot;str&quot;</span>,<span class="hljs-string">&quot;hello receiver2&quot;</span>);<br>        bundle.putInt(<span class="hljs-string">&quot;code&quot;</span>,<span class="hljs-number">200</span>);<br>        setResultExtras(bundle);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderReceiver2</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BroadcastReceiver</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onReceive</span><span class="hljs-params">(Context context, Intent intent)</span> &#123;<br><br>        Log.i(getClass().getName(), <span class="hljs-string">&quot;hello this is receiver2&quot;</span>);<br>        <span class="hljs-type">Bundle</span> <span class="hljs-variable">resultExtras</span> <span class="hljs-operator">=</span> getResultExtras(<span class="hljs-literal">true</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">str</span> <span class="hljs-operator">=</span> resultExtras.getString(<span class="hljs-string">&quot;str&quot;</span>);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">code</span> <span class="hljs-operator">=</span> resultExtras.getInt(<span class="hljs-string">&quot;code&quot;</span>);<br><br>        Log.i(getClass().getName(),<span class="hljs-string">&quot;str = &quot;</span> + str + <span class="hljs-string">&quot; code = &quot;</span> + code );<br><br>        <span class="hljs-type">Bundle</span> <span class="hljs-variable">bundle</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Bundle</span>();<br>        bundle.putString(<span class="hljs-string">&quot;data&quot;</span>,<span class="hljs-string">&quot;hello receiver3&quot;</span>);<br>        setResultExtras(bundle);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderReceiver3</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BroadcastReceiver</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onReceive</span><span class="hljs-params">(Context context, Intent intent)</span> &#123;<br>        Log.i(getClass().getName(),<span class="hljs-string">&quot;this is receiver3&quot;</span>);<br><br>        <span class="hljs-type">String</span> <span class="hljs-variable">data</span> <span class="hljs-operator">=</span> getResultExtras(<span class="hljs-literal">true</span>).getString(<span class="hljs-string">&quot;data&quot;</span>);<br><br>        Log.i(getClass().getName(),<span class="hljs-string">&quot;data = &quot;</span> + data);<br>    &#125;<br>&#125;<br><br><br></code></pre></td></tr></table></figure>

<p> <strong>注册Receiver</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-comment">//设置不同的Priority</span><br><span class="hljs-type">IntentFilter</span> <span class="hljs-variable">intentFilter1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IntentFilter</span>();<br>intentFilter1.addAction(<span class="hljs-string">&quot;com.lier.order&quot;</span>);<br>intentFilter1.setPriority(<span class="hljs-number">3</span>);<br><span class="hljs-type">IntentFilter</span> <span class="hljs-variable">intentFilter2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IntentFilter</span>();<br>intentFilter2.setPriority(<span class="hljs-number">2</span>);<br>intentFilter2.addAction(<span class="hljs-string">&quot;com.lier.order&quot;</span>);<br><span class="hljs-type">IntentFilter</span> <span class="hljs-variable">intentFilter3</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IntentFilter</span>();<br>intentFilter3.addAction(<span class="hljs-string">&quot;com.lier.order&quot;</span>);<br>intentFilter3.setPriority(<span class="hljs-number">1</span>);<br><br>orderReceiver1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderReceiver1</span>();<br>orderReceiver2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderReceiver2</span>();<br>orderReceiver3 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderReceiver3</span>();<br><br>registerReceiver(orderReceiver1,intentFilter1);<br>registerReceiver(orderReceiver2,intentFilter2);<br>registerReceiver(orderReceiver3,intentFilter3);<br><br><br><br></code></pre></td></tr></table></figure>

<p> <strong>输出结果</strong></p>
<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/Snipaste_2023-07-11_11-50-48.png"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/Snipaste_2023-07-11_11-50-48.png" srcset="/img/loading.gif" lazyload alt="Snipaste_2023-07-11_11-50-48"></a></p>
<p>Snipaste_2023-07-11_11-50-48</p>
<h5 id="5-3-3：本地广播"><a href="#5-3-3：本地广播" class="headerlink" title="5.3.3：本地广播"></a>5.3.3：本地广播</h5><p> 前面的广播方式可以在其他应用中接收到，而且可以接受其他应用中的信息，可能造成不安全的因素，可以使用本地广播的方式，只能在应用内部传播，且只能接受来自应用内部的信息</p>
<p> <strong>本地广播是无法通过静态注册的方式来接收的</strong>，因为静态注册广播主要是为了在程序未启动的情况下也能接收广播，而本地广播是应用自己发送的，此时应用肯定是启动的了</p>
<p>本地广播是使用 <strong>LocalBroadcastManager</strong> 来对广播进行管理</p>
<table>
<thead>
<tr>
<th>函数</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td><strong>LocalBroadcastManager</strong>.getInstance(this).registerReceiver(BroadcastReceiver, IntentFilter)</td>
<td>注册Receiver</td>
</tr>
<tr>
<td><strong>LocalBroadcastManager</strong>.getInstance(this).unregisterReceiver(BroadcastReceiver);</td>
<td>注销Receiver</td>
</tr>
<tr>
<td><strong>LocalBroadcastManager</strong>.getInstance(this).sendBroadcast(Intent)</td>
<td>发送异步广播</td>
</tr>
<tr>
<td><strong>LocalBroadcastManager</strong>.getInstance(this).sendBroadcastSync(Intent)</td>
<td>发送同步广播</td>
</tr>
</tbody></table>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LocalReceiver</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BroadcastReceiver</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onReceive</span><span class="hljs-params">(Context context, Intent intent)</span> &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">data</span> <span class="hljs-operator">=</span> intent.getStringExtra(<span class="hljs-string">&quot;data&quot;</span>);<br>        Log.i(getClass().getName(),<span class="hljs-string">&quot;接收到了消息,data = &quot;</span> + data);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//注册 在onResume中</span><br>instance = LocalBroadcastManager.getInstance(<span class="hljs-built_in">this</span>);<br><span class="hljs-type">IntentFilter</span> <span class="hljs-variable">intentFilter4</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IntentFilter</span>();<br>intentFilter4.addAction(<span class="hljs-string">&quot;com.lier.local&quot;</span>);<br>localReceiver = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LocalReceiver</span>();<br>instance.registerReceiver(localReceiver,intentFilter4);<br><br><span class="hljs-comment">//注销 在onPause中</span><br>instance.unregisterReceiver(localReceiver);<br><br><br><span class="hljs-comment">//发送消息</span><br><span class="hljs-type">Intent</span> <span class="hljs-variable">intent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>();<br>intent.setAction(<span class="hljs-string">&quot;com.lier.local&quot;</span>);<br>intent.putExtra(<span class="hljs-string">&quot;data&quot;</span>,<span class="hljs-string">&quot;data&quot;</span>);<br>instance.sendBroadcast(intent);<br><br><br></code></pre></td></tr></table></figure>

<h5 id="5-3-4：自定义权限"><a href="#5-3-4：自定义权限" class="headerlink" title="5.3.4：自定义权限"></a>5.3.4：自定义权限</h5><p> 动态注册广播接收器存在一个问题，即<strong>系统内的任何应用均可监听并触发我们的 Receiver</strong> 。通常情况下我们是不希望如此的，使用私有权限可以指定对应的广播接收器能接受到消息，<strong>系统内不同应用间</strong>指定广播接收器</p>
<p> <strong>&lt; receiver &gt;</strong> 标签添加一个 <strong>android:exported&#x3D;”false”</strong> 属性，标明该 Receiver <strong>仅限应用内部</strong>使用。这样，系统中的其他应用就无法接触到该 Receiver 了</p>
<p> 在系统内不同的应用间，可以自定义权限实现</p>
<p> 创建自己的使用权限，即在清单文件中添加一个 <strong>&lt; permission &gt;</strong> 标签来声明自定义权限</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs XML"><span class="hljs-tag">&lt;<span class="hljs-name">permission</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:name</span>=<span class="hljs-string">&quot;com.example.permission.receiver&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:protectionLevel</span>=<span class="hljs-string">&quot;signature&quot;</span> /&gt;</span><br><br><br></code></pre></td></tr></table></figure>

<p> 自定义权限时必须同时指定 <strong>protectionLevel</strong> 属性值，系统根据该属性值确定自定义权限的使用方式</p>
<table>
<thead>
<tr>
<th>属性值</th>
<th>限定方式</th>
</tr>
</thead>
<tbody><tr>
<td>normal</td>
<td>默认值。较低风险的权限，对其他应用，系统和用户来说风险最小。系统在安装应用时会自动批准授予应用该类型的权限，不要求用户明确批准（虽然用户在安装之前总是可以选择查看这些权限）</td>
</tr>
<tr>
<td>dangerous</td>
<td>较高风险的权限，请求该类型权限的应用程序会访问用户私有数据或对设备进行控制，从而可能对用户造成负面影响。因为这种类型的许可引入了潜在风险，所以系统可能不会自动将其授予请求的应用。例如，系统可以向用户显示由应用请求的任何危险许可，并且在继续之前需要确认，或者可以采取一些其他方法来避免用户自动允许</td>
</tr>
<tr>
<td>signature</td>
<td>只有在请求该权限的应用与声明权限的应用使用相同的证书签名时，系统才会授予权限。如果证书匹配，系统会自动授予权限而不通知用户或要求用户的明确批准</td>
</tr>
<tr>
<td>signatureOrSystem</td>
<td>系统仅授予Android系统映像中与声明权限的应用使用相同的证书签名的应用。请避免使用此选项，“signature”级别足以满足大多数需求，“signatureOrSystem”权限用于某些特殊情况</td>
</tr>
</tbody></table>
<h3 id="6：SQLite详解"><a href="#6：SQLite详解" class="headerlink" title="6：SQLite详解"></a>6：SQLite详解</h3><h4 id="6-1：什么是SQLite"><a href="#6-1：什么是SQLite" class="headerlink" title="6.1：什么是SQLite"></a>6.1：什么是SQLite</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mathematica">是数据库，是<span class="hljs-variable">Android</span>系统提供的数据存贮方式之一<br><span class="hljs-variable">SQLite</span>占用的资源非常少，只有几百<span class="hljs-built_in">K</span><br><span class="hljs-variable">SQLite</span>不仅支持标准的<span class="hljs-variable">SQL</span>语句<span class="hljs-operator">,</span>还遵循数据库的<span class="hljs-variable">ACID</span>事务<br><span class="hljs-variable">SQLite</span>不需要安装，不需要用户名和密码就可以使用<br></code></pre></td></tr></table></figure>

<h4 id="6-2：能做什么"><a href="#6-2：能做什么" class="headerlink" title="6.2：能做什么"></a>6.2：能做什么</h4><p>类似于Mysql持久化数据到本地</p>
<h4 id="6-3：SQLite使用"><a href="#6-3：SQLite使用" class="headerlink" title="6.3：SQLite使用"></a>6.3：SQLite使用</h4><h5 id="6-3-1：SQLiteOpenHelper中常用API"><a href="#6-3-1：SQLiteOpenHelper中常用API" class="headerlink" title="6.3.1：SQLiteOpenHelper中常用API"></a>6.3.1：SQLiteOpenHelper中常用API</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"> <span class="hljs-comment">// 1. 创建 or 打开 可读/写的数据库（通过 返回的SQLiteDatabase对象 进行操作）</span><br> getWritableDatabase（）<br><br> <span class="hljs-comment">// 2. 创建 or 打开 可读的数据库（通过 返回的SQLiteDatabase对象 进行操作）</span><br> getReadableDatabase（）<br><br> <span class="hljs-comment">// 3. 数据库第1次创建时 则会调用，即 第1次调用 getWritableDatabase（） / getReadableDatabase（）时调用</span><br> <span class="hljs-comment">// 在继承SQLiteOpenHelper类的子类中复写</span><br> onCreate(SQLiteDatabase db) <br><br> <span class="hljs-comment">// 4. 数据库升级时自动调用</span><br> <span class="hljs-comment">// 在继承SQLiteOpenHelper类的子类中复写</span><br> onUpgrade(SQLiteDatabase db, <span class="hljs-type">int</span> oldVersion, <span class="hljs-type">int</span> newVersion)<br><br> <span class="hljs-comment">// 5. 关闭数据库</span><br> close（）<br><br> <span class="hljs-comment">/** </span><br><span class="hljs-comment">  *  数据库操作（增、删、减、查）</span><br><span class="hljs-comment">  */</span> <br> <span class="hljs-comment">// 1. 查询数据</span><br> (Cursor) query(String table, String[] columns, String selection, String[] selectionArgs, String groupBy, String having, String orderBy, String limit)  <br> <span class="hljs-comment">// 查询指定的数据表返回一个带游标的数据集。</span><br> <span class="hljs-comment">// 各参数说明： </span><br> <span class="hljs-comment">// table：表名称 </span><br> <span class="hljs-comment">// colums：列名称数组 </span><br> <span class="hljs-comment">// selection：条件子句，相当于where </span><br> <span class="hljs-comment">// selectionArgs：条件语句的参数数组 </span><br> <span class="hljs-comment">// groupBy：分组 </span><br> <span class="hljs-comment">// having：分组条件 </span><br> <span class="hljs-comment">// orderBy：排序类 </span><br> <span class="hljs-comment">// limit：分页查询的限制 </span><br> <span class="hljs-comment">// Cursor：返回值，相当于结果集ResultSet </span><br><br> (Cursor) rawQuery(String sql, String[] selectionArgs) <br> <span class="hljs-comment">//运行一个预置的SQL语句，返回带游标的数据集（与上面的语句最大的区别 = 防止SQL注入）</span><br><br> <span class="hljs-comment">// 2. 删除数据行  </span><br> (<span class="hljs-type">int</span>) delete(String table,String whereClause,String[] whereArgs) <br> <br> <span class="hljs-comment">// 3. 添加数据行 </span><br> (<span class="hljs-type">long</span>) insert(String table,String nullColumnHack,ContentValues values) <br> <br> <span class="hljs-comment">// 4. 更新数据行 </span><br>(<span class="hljs-type">int</span>) update(String table, ContentValues values, String whereClause, String[] whereArgs) <br> <br> <span class="hljs-comment">// 5. 执行一个SQL语句，可以是一个select or 其他sql语句 </span><br> <span class="hljs-comment">// 即 直接使用String类型传入sql语句 &amp; 执行</span><br> (<span class="hljs-keyword">void</span>) execSQL(String sql)<br><br><br></code></pre></td></tr></table></figure>

<h5 id="6-3-2：使用步骤"><a href="#6-3-2：使用步骤" class="headerlink" title="6.3.2：使用步骤"></a>6.3.2：使用步骤</h5><p> 1：自定义数据库子类（基础SQLiteOpenHelper）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MySQLiteHelper</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">SQLiteOpenHelper</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Context context;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">MySQLiteHelper</span><span class="hljs-params">(Context context, String name, SQLiteDatabase.CursorFactory factory, <span class="hljs-type">int</span> version)</span> &#123;<br>        <span class="hljs-built_in">super</span>(context, name, factory, version);<br>        <span class="hljs-built_in">this</span>.context = context;<br>    &#125;<br><br><br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(SQLiteDatabase sqLiteDatabase)</span> &#123;<br>            <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;create table user(id bigint primary key autoincrement,&quot;</span> +<br>                    <span class="hljs-string">&quot;name varchar(20),&quot;</span> +<br>                    <span class="hljs-string">&quot;phone varchar(20))&quot;</span>;<br><br>            sqLiteDatabase.execSQL(sql);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onUpgrade</span><span class="hljs-params">(SQLiteDatabase sqLiteDatabase, <span class="hljs-type">int</span> i, <span class="hljs-type">int</span> i1)</span> &#123;<br>            Log.i(<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-string">&quot;数据库新版 = &quot;</span> + i1);<br>    &#125;<br>&#125;<br><br><br></code></pre></td></tr></table></figure>

<p> 2：activity界面实现增删改查</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//MainActivity.class</span><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">View</span>.OnClickListener&#123;<br><br>    <span class="hljs-keyword">private</span> MySQLiteHelper mySQLiteHelper;<br><br>    <span class="hljs-keyword">private</span> SQLiteDatabase writableDatabase;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);<br>        setContentView(R.layout.activity_main);<br><br>        findViewById(R.id.create).setOnClickListener(<span class="hljs-built_in">this</span>);<br>        findViewById(R.id.insert).setOnClickListener(<span class="hljs-built_in">this</span>);<br>        findViewById(R.id.delete).setOnClickListener(<span class="hljs-built_in">this</span>);<br>        findViewById(R.id.update).setOnClickListener(<span class="hljs-built_in">this</span>);<br>        findViewById(R.id.select).setOnClickListener(<span class="hljs-built_in">this</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onClick</span><span class="hljs-params">(View view)</span> &#123;<br>        <span class="hljs-keyword">if</span>(view.getId() == R.id.create)&#123;<br>            <span class="hljs-keyword">if</span>(mySQLiteHelper == <span class="hljs-literal">null</span>)&#123;<br>                mySQLiteHelper = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MySQLiteHelper</span>(MainActivity.<span class="hljs-built_in">this</span>,<span class="hljs-string">&quot;user_db&quot;</span>,<span class="hljs-literal">null</span>,<span class="hljs-number">1</span>);<br>            &#125;<br>            writableDatabase = mySQLiteHelper.getWritableDatabase();<br>            Log.i(getClass().getName(),<span class="hljs-string">&quot;数据库创建成功&quot;</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">if</span>(view.getId() == R.id.insert)&#123;<br>            <span class="hljs-type">EditText</span> <span class="hljs-variable">idText</span> <span class="hljs-operator">=</span> findViewById(R.id.id);<br>            <span class="hljs-type">EditText</span> <span class="hljs-variable">nameText</span> <span class="hljs-operator">=</span> findViewById(R.id.name);<br>            <span class="hljs-type">EditText</span> <span class="hljs-variable">phoneText</span> <span class="hljs-operator">=</span> findViewById(R.id.phone);<br>            <span class="hljs-type">String</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> idText.getText().toString();<br>            <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> nameText.getText().toString();<br>            <span class="hljs-type">String</span> <span class="hljs-variable">phone</span> <span class="hljs-operator">=</span> phoneText.getText().toString();<br><br>            <span class="hljs-type">ContentValues</span> <span class="hljs-variable">contentValues</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ContentValues</span>();<br>            contentValues.put(<span class="hljs-string">&quot;id&quot;</span>,id);<br>            contentValues.put(<span class="hljs-string">&quot;name&quot;</span>,name);<br>            contentValues.put(<span class="hljs-string">&quot;phone&quot;</span>,phone);<br><br><br>            writableDatabase.insert(<span class="hljs-string">&quot;user&quot;</span>,<span class="hljs-literal">null</span>,contentValues);<br>            Log.i(<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-string">&quot;id = &quot;</span> + id + <span class="hljs-string">&quot; 的数据插入成功&quot;</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">if</span>(view.getId() == R.id.update)&#123;<br>            <span class="hljs-type">EditText</span> <span class="hljs-variable">idText</span> <span class="hljs-operator">=</span> findViewById(R.id.id);<br>            <span class="hljs-type">EditText</span> <span class="hljs-variable">nameText</span> <span class="hljs-operator">=</span> findViewById(R.id.name);<br>            <span class="hljs-type">EditText</span> <span class="hljs-variable">phoneText</span> <span class="hljs-operator">=</span> findViewById(R.id.phone);<br>            <span class="hljs-type">String</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> idText.getText().toString();<br>            <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> nameText.getText().toString();<br>            <span class="hljs-type">String</span> <span class="hljs-variable">phone</span> <span class="hljs-operator">=</span> phoneText.getText().toString();<br><br>            <span class="hljs-type">ContentValues</span> <span class="hljs-variable">contentValues</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ContentValues</span>();<br>            contentValues.put(<span class="hljs-string">&quot;name&quot;</span>,name);<br>            contentValues.put(<span class="hljs-string">&quot;phone&quot;</span>,phone);<br><br><br>            writableDatabase.update(<span class="hljs-string">&quot;user&quot;</span>,contentValues,<span class="hljs-string">&quot;id = ?&quot;</span>,<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[]&#123;id&#125;);<br>            Log.i(<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-string">&quot;id = &quot;</span> + id + <span class="hljs-string">&quot; 的数据修改成功&quot;</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">if</span>(view.getId() == R.id.delete)&#123;<br>            <span class="hljs-type">EditText</span> <span class="hljs-variable">idText</span> <span class="hljs-operator">=</span> findViewById(R.id.id);<br>            <span class="hljs-type">String</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> idText.getText().toString();<br><br>            writableDatabase.delete(<span class="hljs-string">&quot;user&quot;</span>,<span class="hljs-string">&quot;id = ?&quot;</span>,<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[]&#123;id&#125;);<br>            Log.i(<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-string">&quot;id = &quot;</span> + id + <span class="hljs-string">&quot; 的数据删除成功&quot;</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">if</span>(view.getId() == R.id.select)&#123;<br>            <span class="hljs-type">Cursor</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> writableDatabase.query(<span class="hljs-string">&quot;user&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[]&#123;<span class="hljs-string">&quot;id&quot;</span>, <span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;phone&quot;</span>&#125;,<br>                    <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);<br>            <span class="hljs-type">String</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>            <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>            <span class="hljs-type">String</span> <span class="hljs-variable">phone</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>            <span class="hljs-keyword">while</span>(user.moveToNext())&#123;<br>                <span class="hljs-type">int</span> <span class="hljs-variable">idIndex</span> <span class="hljs-operator">=</span> user.getColumnIndex(<span class="hljs-string">&quot;id&quot;</span>);<br>                id = user.getString(idIndex);<br>                <span class="hljs-type">int</span> <span class="hljs-variable">nameIndex</span> <span class="hljs-operator">=</span> user.getColumnIndex(<span class="hljs-string">&quot;name&quot;</span>);<br>                name = user.getString(nameIndex);<br>                <span class="hljs-type">int</span> <span class="hljs-variable">phoneIndex</span> <span class="hljs-operator">=</span> user.getColumnIndex(<span class="hljs-string">&quot;phone&quot;</span>);<br>                phone = user.getString(phoneIndex);<br><br>                System.out.println(<span class="hljs-string">&quot;输出结果 id = &quot;</span> + id + <span class="hljs-string">&quot; name = &quot;</span> + name + <span class="hljs-string">&quot; phone = &quot;</span> + phone);<br>            &#125;<br><br>        &#125;<br>    &#125;<br>&#125;<br><br>&lt;!-- activity_main.xml --&gt;<br><br>&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;<br>&lt;LinearLayout xmlns:android=<span class="hljs-string">&quot;http://schemas.android.com/apk/res/android&quot;</span><br>    android:orientation=<span class="hljs-string">&quot;vertical&quot;</span><br>    android:layout_width=<span class="hljs-string">&quot;match_parent&quot;</span><br>    android:layout_height=<span class="hljs-string">&quot;match_parent&quot;</span>&gt;<br><br><br>    &lt;EditText<br>        android:id=<span class="hljs-string">&quot;@+id/id&quot;</span><br>        android:layout_width=<span class="hljs-string">&quot;match_parent&quot;</span><br>        android:layout_height=<span class="hljs-string">&quot;wrap_content&quot;</span><br>        android:ems=<span class="hljs-string">&quot;10&quot;</span><br>        android:inputType=<span class="hljs-string">&quot;textPersonName&quot;</span><br>        android:text=<span class="hljs-string">&quot;id&quot;</span> /&gt;<br><br>    &lt;EditText<br>        android:id=<span class="hljs-string">&quot;@+id/name&quot;</span><br>        android:layout_width=<span class="hljs-string">&quot;match_parent&quot;</span><br>        android:layout_height=<span class="hljs-string">&quot;wrap_content&quot;</span><br>        android:ems=<span class="hljs-string">&quot;10&quot;</span><br>        android:inputType=<span class="hljs-string">&quot;textPersonName&quot;</span><br>        android:text=<span class="hljs-string">&quot;name&quot;</span> /&gt;<br><br>    &lt;EditText<br>        android:id=<span class="hljs-string">&quot;@+id/phone&quot;</span><br>        android:layout_width=<span class="hljs-string">&quot;match_parent&quot;</span><br>        android:layout_height=<span class="hljs-string">&quot;wrap_content&quot;</span><br>        android:ems=<span class="hljs-string">&quot;10&quot;</span><br>        android:inputType=<span class="hljs-string">&quot;textPersonName&quot;</span><br>        android:text=<span class="hljs-string">&quot;phone&quot;</span> /&gt;<br><br>    &lt;Button<br>        android:id=<span class="hljs-string">&quot;@+id/create&quot;</span><br>        android:layout_width=<span class="hljs-string">&quot;match_parent&quot;</span><br>        android:layout_height=<span class="hljs-string">&quot;wrap_content&quot;</span><br>        android:text=<span class="hljs-string">&quot;创建数据库&quot;</span> /&gt;<br><br>    &lt;Button<br>        android:id=<span class="hljs-string">&quot;@+id/insert&quot;</span><br>        android:layout_width=<span class="hljs-string">&quot;match_parent&quot;</span><br>        android:layout_height=<span class="hljs-string">&quot;wrap_content&quot;</span><br>        android:text=<span class="hljs-string">&quot;insert&quot;</span> /&gt;<br><br>    &lt;Button<br>        android:id=<span class="hljs-string">&quot;@+id/update&quot;</span><br>        android:layout_width=<span class="hljs-string">&quot;match_parent&quot;</span><br>        android:layout_height=<span class="hljs-string">&quot;wrap_content&quot;</span><br>        android:text=<span class="hljs-string">&quot;update&quot;</span> /&gt;<br><br>    &lt;Button<br>        android:id=<span class="hljs-string">&quot;@+id/delete&quot;</span><br>        android:layout_width=<span class="hljs-string">&quot;match_parent&quot;</span><br>        android:layout_height=<span class="hljs-string">&quot;wrap_content&quot;</span><br>        android:text=<span class="hljs-string">&quot;delete&quot;</span> /&gt;<br><br>    &lt;Button<br>        android:id=<span class="hljs-string">&quot;@+id/select&quot;</span><br>        android:layout_width=<span class="hljs-string">&quot;match_parent&quot;</span><br>        android:layout_height=<span class="hljs-string">&quot;wrap_content&quot;</span><br>        android:text=<span class="hljs-string">&quot;select&quot;</span> /&gt;<br><br>&lt;/LinearLayout&gt;<br><br><br></code></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/071210470947_0Snipaste_2023-07-12_10-45-50.png"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/071210470947_0Snipaste_2023-07-12_10-45-50.png" srcset="/img/loading.gif" lazyload alt="071210470947_0Snipaste_2023-07-12_10-45-50"></a></p>
<p>071210470947_0Snipaste_2023-07-12_10-45-50</p>
<h3 id="7：ContentProvider详解"><a href="#7：ContentProvider详解" class="headerlink" title="7：ContentProvider详解"></a>7：ContentProvider详解</h3><h4 id="7-1：什么是ContentProvider"><a href="#7-1：什么是ContentProvider" class="headerlink" title="7.1：什么是ContentProvider"></a>7.1：什么是ContentProvider</h4><ul>
<li>ContentProvider是Android的四大组件之一，以标准化的方式在Android 应用间共享数据。</li>
<li>ContentProvider封装的数据存储以及增删改查等，并且必须实现一个对外统一的接口（Uri）。</li>
</ul>
<p>Uri(通用资源标识符 Universal Resource Identifer)，代表数据操作的地址，每一个ContentProvider都会有唯一的地址。</p>
<p>ContentProvider使用的Uri语法结构如下：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">content:<span class="hljs-regexp">//</span>authority<span class="hljs-regexp">/data_path/i</span>d<br></code></pre></td></tr></table></figure>

<ul>
<li><strong>content:&#x2F;&#x2F;</strong> 是通用前缀，表示该Uri用于ContentProvider定位资源。</li>
<li><strong>authority</strong> 是授权者名称，用来确定具体由哪一个ContentProvider提供资源。因此一般authority都由类的小写全称组成，以保证唯一性。</li>
<li><strong>data_path</strong> 是数据路径，用来确定请求的是哪个数据集。</li>
<li><strong>id</strong> 是数据编号，用来请求单条数据。如果是多条这个字段忽略。</li>
</ul>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">content:<span class="hljs-regexp">//</span>com.scc.userprovider/user多条<br>content:<span class="hljs-regexp">//</span>com.scc.userprovider<span class="hljs-regexp">/user/</span><span class="hljs-number">10</span>单条<br></code></pre></td></tr></table></figure>

<h4 id="7-2：什么是ContentResolver"><a href="#7-2：什么是ContentResolver" class="headerlink" title="7.2：什么是ContentResolver"></a>7.2：什么是ContentResolver</h4><ul>
<li>ContentResolver是数据调用者，ContentProvider将数据发布出来，通过ContentResolver对象结合Uri进行调用。</li>
<li>一般来说ContentProvider是单例模式，多个应用可通过ContentResolver调用ContentProvider的增删改查操作数据，ContentResolver调用的数据操作会让同一个ContentProvider处理。</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/8498518-ec4f012859b2d8fb.png"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/8498518-ec4f012859b2d8fb.png" srcset="/img/loading.gif" lazyload alt="img"></a></p>
<h4 id="7-3：ContentProvider实例"><a href="#7-3：ContentProvider实例" class="headerlink" title="7.3：ContentProvider实例"></a>7.3：ContentProvider实例</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>.使用SQLite技术，创建好数据库和数据表<br><span class="hljs-attribute">2</span>.新建类继承ContentProvider，重写<span class="hljs-number">6</span>个抽象方法，创建UriMatcher，定义Uri规则<br><span class="hljs-attribute">3</span>.在Manifest中注册provider<br><span class="hljs-attribute">4</span>.ContentResolver对ContentProvider中共享的数据进行增删改查操作<br></code></pre></td></tr></table></figure>

<h5 id="7-3-1-使用SQLite技术，创建好数据库和数据表"><a href="#7-3-1-使用SQLite技术，创建好数据库和数据表" class="headerlink" title="7.3.1.使用SQLite技术，创建好数据库和数据表"></a>7.3.1.使用SQLite技术，创建好数据库和数据表</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SQLiteHelper</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">SQLiteOpenHelper</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">SQLiteHelper</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Context context, <span class="hljs-meta">@Nullable</span> String name,</span><br><span class="hljs-params">                        <span class="hljs-meta">@Nullable</span> SQLiteDatabase.CursorFactory factory, <span class="hljs-type">int</span> version)</span> &#123;<br>        <span class="hljs-built_in">super</span>(context, name, factory, version);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(SQLiteDatabase sqLiteDatabase)</span> &#123;<br>        <br>        <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;create table provider(id integer primary key autoincrement,&quot;</span> +<br>                <span class="hljs-string">&quot;provider varchar(20))&quot;</span>;<br>        <br>        sqLiteDatabase.execSQL(sql);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onUpgrade</span><span class="hljs-params">(SQLiteDatabase sqLiteDatabase, <span class="hljs-type">int</span> i, <span class="hljs-type">int</span> i1)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;newVersion = &quot;</span> + i1);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//在ContentProvider的create中创建数据库和数据库表</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyContentProvider</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ContentProvider</span> &#123;<br>    <br>    <span class="hljs-keyword">private</span> SQLiteDatabase writableDatabase;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">SQLiteHelper</span> <span class="hljs-variable">sqLiteHelper</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SQLiteHelper</span>(getContext(),<span class="hljs-string">&quot;provider_db&quot;</span>,<span class="hljs-literal">null</span>,<span class="hljs-number">1</span>);<br>        writableDatabase = sqLiteHelper.getWritableDatabase();<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br><br>    &#125;<br>&#125;<br><br><br></code></pre></td></tr></table></figure>

<h5 id="7-3-2-继承ContentProvider，定义Uri规则"><a href="#7-3-2-继承ContentProvider，定义Uri规则" class="headerlink" title="7.3.2.继承ContentProvider，定义Uri规则"></a>7.3.2.继承ContentProvider，定义Uri规则</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyContentProvider</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ContentProvider</span> &#123;<br><br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">USER_DIR</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">USER_ITEM</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br><br>    <span class="hljs-comment">//创建authority</span><br>    <span class="hljs-comment">//此处的值必须和Manifest.xml文件中注册的provider的android:authorities的值一致</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">AUTHORITY</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;com.lier.contentprovider&quot;</span>;<br><br>    <span class="hljs-comment">//创建UriMatcher</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> UriMatcher uriMatcher;<br><br>    <span class="hljs-keyword">private</span> SQLiteDatabase writableDatabase;<br><br>    <span class="hljs-keyword">static</span> &#123;<br>        <span class="hljs-comment">//实例化utiMatcher</span><br>        uriMatcher = <span class="hljs-keyword">new</span> <span class="hljs-title class_">UriMatcher</span>(UriMatcher.NO_MATCH);<br><br>        <span class="hljs-comment">//可以实现匹配URI的功能</span><br>        <span class="hljs-comment">//参数1：authority 参数2：路径 参数3：自定义代码</span><br>        uriMatcher.addURI(AUTHORITY,<span class="hljs-string">&quot;user&quot;</span>,USER_DIR);<br>        uriMatcher.addURI(AUTHORITY,<span class="hljs-string">&quot;user/#&quot;</span>,USER_ITEM);<br>    &#125;<br>       <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">SQLiteHelper</span> <span class="hljs-variable">sqLiteHelper</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SQLiteHelper</span>(getContext(),<span class="hljs-string">&quot;provider_db&quot;</span>,<span class="hljs-literal">null</span>,<span class="hljs-number">1</span>);<br>        writableDatabase = sqLiteHelper.getWritableDatabase();<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Nullable</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Cursor <span class="hljs-title function_">query</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> Uri uri, <span class="hljs-meta">@Nullable</span> String[] strings, <span class="hljs-meta">@Nullable</span> String s, <span class="hljs-meta">@Nullable</span> String[] strings1, <span class="hljs-meta">@Nullable</span> String s1)</span> &#123;<br>        <span class="hljs-type">Cursor</span> <span class="hljs-variable">provider</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">switch</span> (uriMatcher.match(uri))&#123;<br>            <span class="hljs-keyword">case</span> USER_DIR:<br>                provider = writableDatabase.query(<span class="hljs-string">&quot;provider&quot;</span>, strings, s, strings1, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, s1);<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> USER_ITEM:<br>                <span class="hljs-type">String</span> <span class="hljs-variable">queryId</span> <span class="hljs-operator">=</span> uri.getPathSegments().get(<span class="hljs-number">1</span>);<br>                provider = writableDatabase.query(<span class="hljs-string">&quot;provider&quot;</span>, strings, <span class="hljs-string">&quot;id = ?&quot;</span><br>                        , <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[]&#123;queryId&#125;, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, s1);<br>        &#125;<br>        <span class="hljs-keyword">return</span> provider;<br>    &#125;<br><br>    <span class="hljs-meta">@Nullable</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getType</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> Uri uri)</span> &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UnsupportedOperationException</span>();<br>    &#125;<br><br>    <span class="hljs-meta">@Nullable</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Uri <span class="hljs-title function_">insert</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> Uri uri, <span class="hljs-meta">@Nullable</span> ContentValues contentValues)</span> &#123;<br>        <span class="hljs-keyword">switch</span> (uriMatcher.match(uri))&#123;<br>            <span class="hljs-keyword">case</span> USER_DIR:<br>            <span class="hljs-keyword">case</span> USER_ITEM:<br>                <span class="hljs-type">long</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> writableDatabase.insert(<span class="hljs-string">&quot;provider&quot;</span>,<span class="hljs-literal">null</span>,contentValues);<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">default</span>:<br>                <span class="hljs-keyword">break</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">delete</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> Uri uri, <span class="hljs-meta">@Nullable</span> String s, <span class="hljs-meta">@Nullable</span> String[] strings)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">deleteInt</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">switch</span> (uriMatcher.match(uri))&#123;<br>            <span class="hljs-keyword">case</span> USER_DIR:<br>                deleteInt = writableDatabase.delete(<span class="hljs-string">&quot;provider&quot;</span>, s, strings);<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> USER_ITEM:<br>                <span class="hljs-type">String</span> <span class="hljs-variable">deleteId</span> <span class="hljs-operator">=</span> uri.getPathSegments().get(<span class="hljs-number">1</span>);<br>                deleteInt = writableDatabase.delete(<span class="hljs-string">&quot;provider&quot;</span>,<span class="hljs-string">&quot;id = ?&quot;</span>,<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[]&#123;deleteId&#125;);<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> deleteInt;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">update</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> Uri uri, <span class="hljs-meta">@Nullable</span> ContentValues contentValues, <span class="hljs-meta">@Nullable</span> String s, <span class="hljs-meta">@Nullable</span> String[] strings)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">updateInt</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">switch</span> (uriMatcher.match(uri))&#123;<br>            <span class="hljs-keyword">case</span> USER_DIR:<br>                updateInt = writableDatabase.update(<span class="hljs-string">&quot;provider&quot;</span>,contentValues,s,strings);<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> USER_ITEM:<br>                <span class="hljs-type">String</span> <span class="hljs-variable">updateId</span> <span class="hljs-operator">=</span> uri.getPathSegments().get(<span class="hljs-number">1</span>);<br>                updateInt = writableDatabase.update(<span class="hljs-string">&quot;provider&quot;</span>,contentValues,<span class="hljs-string">&quot;id = ?&quot;</span>,<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[]&#123;updateId&#125;);<br>        &#125;<br>        <span class="hljs-keyword">return</span> updateInt;<br>    &#125;<br>&#125;<br><br><br></code></pre></td></tr></table></figure>

<h5 id="7-3-3-在Manifest中注册provider"><a href="#7-3-3-在Manifest中注册provider" class="headerlink" title="7.3.3.在Manifest中注册provider"></a>7.3.3.在Manifest中注册provider</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs XML"><span class="hljs-tag">&lt;<span class="hljs-name">provider</span></span><br><span class="hljs-tag">          <span class="hljs-attr">android:authorities</span>=<span class="hljs-string">&quot;com.lier.contentprovider&quot;</span></span><br><span class="hljs-tag">          <span class="hljs-attr">android:name</span>=<span class="hljs-string">&quot;.MyContentProvider&quot;</span>/&gt;</span><br><br><br></code></pre></td></tr></table></figure>

<h5 id="7-4-4-增删改查操作"><a href="#7-4-4-增删改查操作" class="headerlink" title="7.4.4.增删改查操作"></a>7.4.4.增删改查操作</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">View</span>.OnClickListener&#123;<br><br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);<br>        setContentView(R.layout.activity_main);<br><br>        findViewById(R.id.query).setOnClickListener(<span class="hljs-built_in">this</span>);<br>        findViewById(R.id.delete).setOnClickListener(<span class="hljs-built_in">this</span>);<br>        findViewById(R.id.update).setOnClickListener(<span class="hljs-built_in">this</span>);<br>        findViewById(R.id.insert).setOnClickListener(<span class="hljs-built_in">this</span>);<br><br>    &#125;<br><br>    <span class="hljs-meta">@SuppressLint(&quot;Range&quot;)</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onClick</span><span class="hljs-params">(View view)</span> &#123;<br>        <span class="hljs-keyword">if</span>(view.getId() == R.id.query)&#123;<br>            <span class="hljs-type">Uri</span> <span class="hljs-variable">parse</span> <span class="hljs-operator">=</span> Uri.parse(<span class="hljs-string">&quot;content://com.lier.contentprovider/user&quot;</span>);<br>            <span class="hljs-type">Cursor</span> <span class="hljs-variable">query</span> <span class="hljs-operator">=</span> getContentResolver().query(parse, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);<br>            <span class="hljs-keyword">while</span>(query.moveToNext())&#123;<br>                <span class="hljs-type">int</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> query.getInt(query.getColumnIndex(<span class="hljs-string">&quot;id&quot;</span>));<br>                <span class="hljs-type">String</span> <span class="hljs-variable">provider</span> <span class="hljs-operator">=</span> query.getString(query.getColumnIndex(<span class="hljs-string">&quot;provider&quot;</span>));<br>                System.out.println(<span class="hljs-string">&quot;provider&#123;id = &quot;</span> + id +  <span class="hljs-string">&quot;,provider = &quot;</span> + provider + <span class="hljs-string">&quot;&#125;&quot;</span>);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(view.getId() == R.id.insert)&#123;<br>            <span class="hljs-type">Uri</span> <span class="hljs-variable">parse</span> <span class="hljs-operator">=</span> Uri.parse(<span class="hljs-string">&quot;content://com.lier.contentprovider/user&quot;</span>);<br>            <span class="hljs-type">ContentValues</span> <span class="hljs-variable">contentValues</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ContentValues</span>();<br><br>            <span class="hljs-type">EditText</span> <span class="hljs-variable">text</span> <span class="hljs-operator">=</span> findViewById(R.id.provider);<br>            <span class="hljs-type">String</span> <span class="hljs-variable">provider</span> <span class="hljs-operator">=</span> text.getText().toString();<br><br>            contentValues.put(<span class="hljs-string">&quot;provider&quot;</span>,provider);<br><br>            getContentResolver().insert(parse,contentValues);<br>            Log.i(<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-string">&quot;添加成功&quot;</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">if</span>(view.getId() == R.id.update)&#123;<br>            <span class="hljs-type">Uri</span> <span class="hljs-variable">parse</span> <span class="hljs-operator">=</span> Uri.parse(<span class="hljs-string">&quot;content://com.lier.contentprovider/user&quot;</span>);<br>            <span class="hljs-type">ContentValues</span> <span class="hljs-variable">contentValues</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ContentValues</span>();<br><br>            <span class="hljs-type">EditText</span> <span class="hljs-variable">text</span> <span class="hljs-operator">=</span> findViewById(R.id.provider);<br>            <span class="hljs-type">EditText</span> <span class="hljs-variable">idText</span> <span class="hljs-operator">=</span> findViewById(R.id.id);<br><br>            <span class="hljs-type">String</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> idText.getText().toString();<br>            <span class="hljs-type">String</span> <span class="hljs-variable">provider</span> <span class="hljs-operator">=</span> text.getText().toString();<br><br>            contentValues.put(<span class="hljs-string">&quot;provider&quot;</span>,provider);<br>            contentValues.put(<span class="hljs-string">&quot;id&quot;</span>,id);<br>            getContentResolver().update(parse,contentValues,<span class="hljs-string">&quot;id = ?&quot;</span>,<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[]&#123;id&#125;);<br>            Log.i(<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-string">&quot;修改&quot;</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">if</span>(view.getId() == R.id.delete)&#123;<br>            <span class="hljs-type">Uri</span> <span class="hljs-variable">parse</span> <span class="hljs-operator">=</span> Uri.parse(<span class="hljs-string">&quot;content://com.lier.contentprovider/user&quot;</span>);<br><br>            <span class="hljs-type">EditText</span> <span class="hljs-variable">idText</span> <span class="hljs-operator">=</span> findViewById(R.id.id);<br>            <span class="hljs-type">String</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> idText.getText().toString();<br><br>            getContentResolver().delete(parse,<span class="hljs-string">&quot;id = ?&quot;</span>,<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[]&#123;id&#125;);<br>            Log.i(<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-string">&quot;删除成功&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br><br></code></pre></td></tr></table></figure>

<h5 id="7-4-5-最终效果"><a href="#7-4-5-最终效果" class="headerlink" title="7.4.5.最终效果"></a>7.4.5.最终效果</h5><p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/071214402071_0Snipaste_2023-07-12_14-39-05.png"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/071214402071_0Snipaste_2023-07-12_14-39-05.png" srcset="/img/loading.gif" lazyload alt="071214402071_0Snipaste_2023-07-12_14-39-05"></a></p>
<p>071214402071_0Snipaste_2023-07-12_14-39-05</p>
<h3 id="8：View"><a href="#8：View" class="headerlink" title="8：View"></a>8：View</h3><p> <strong>所有的用户界面元素都是由View和ViewGroup的对象构成的。View是绘制在屏幕上的用户能与之交互的一个对象。而ViewGroup则是一个用于存放其他View（和ViewGroup）对象的布局容器</strong>！ Android为我们提供了一个View和ViewGroup子类的集合，集合中提供了一些常用的输入控件(比如按钮和文本域)和各种各样的布局模式（比如线性或相对布局）</p>
<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/68789093.jpg"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/68789093.jpg" srcset="/img/loading.gif" lazyload alt="img"></a></p>
<h4 id="8-1：UI组件"><a href="#8-1：UI组件" class="headerlink" title="8.1：UI组件"></a>8.1：UI组件</h4><p>View组件包含了几乎所有的图形显示组件</p>
<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/2019040820130691.png"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/2019040820130691.png" srcset="/img/loading.gif" lazyload alt="img"></a></p>
<table>
<thead>
<tr>
<th>组件</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>TextView</td>
<td>一个文本的显示组件</td>
</tr>
<tr>
<td>Button</td>
<td>一个普通的按钮</td>
</tr>
<tr>
<td>EditText</td>
<td>一个可编辑的文本框组件</td>
</tr>
<tr>
<td>CheckBox</td>
<td>复选框组件</td>
</tr>
<tr>
<td>RadioGroup</td>
<td>单选按钮组件</td>
</tr>
<tr>
<td>Spinner</td>
<td>下拉列表框</td>
</tr>
<tr>
<td>DatePicker</td>
<td>日期选择组件</td>
</tr>
<tr>
<td>TimePicker</td>
<td>时间选择组件</td>
</tr>
<tr>
<td>ScrollView</td>
<td>滚动条</td>
</tr>
<tr>
<td>ProgressBar</td>
<td>进度处理条</td>
</tr>
<tr>
<td>SeekBar</td>
<td>拖动条组件</td>
</tr>
<tr>
<td>RatingBar</td>
<td>评分组件</td>
</tr>
<tr>
<td>ImageView</td>
<td>图片显示组件</td>
</tr>
<tr>
<td>ImageButton</td>
<td>图片按钮</td>
</tr>
<tr>
<td>AutoCompleteTextView</td>
<td>自动完成文本组件</td>
</tr>
<tr>
<td>Dialog</td>
<td>对话框组件</td>
</tr>
<tr>
<td>Toast</td>
<td>信息提示框组件</td>
</tr>
<tr>
<td>Menu</td>
<td>菜单显示组件</td>
</tr>
</tbody></table>
<p> <strong>样式复用</strong></p>
<p> 在values目录下定义样式表styles.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs XML"><span class="hljs-tag">&lt;<span class="hljs-name">resources</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;AppBaseTheme&quot;</span> <span class="hljs-attr">parent</span>=<span class="hljs-string">&quot;android:Theme.Light&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;textViewStyle&quot;</span> <span class="hljs-attr">parent</span>=<span class="hljs-string">&quot;AppBaseTheme&quot;</span>&gt;</span><span class="language-xml"></span><br><span class="language-xml">        <span class="hljs-comment">&lt;!-- All customizations that are NOT specific to a particular API-level can go here. --&gt;</span></span><br><span class="language-xml">         <span class="hljs-tag">&lt;<span class="hljs-name">item</span>  <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;android:textSize&quot;</span>&gt;</span>20px<span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">item</span>  <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;android:textColor&quot;</span>&gt;</span>#FF00<span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">item</span>  <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;android:autoLink&quot;</span>&gt;</span>all<span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">item</span>  <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;android:textStyle&quot;</span>&gt;</span>bold<span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">item</span>  <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;android:layout_width&quot;</span>&gt;</span>wrap_content<span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">item</span>  <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;android:layout_height&quot;</span>&gt;</span>wrap_content<span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span></span><br><span class="language-xml">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">resources</span>&gt;</span><br><br><span class="hljs-comment">&lt;!-- 组件引用该style --&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">TextView</span>  </span><br><span class="hljs-tag">        <span class="hljs-attr">android:id</span>=<span class="hljs-string">&quot;@+id/myText7&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;@style/textViewStyle&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:text</span>=<span class="hljs-string">&quot;网址:www.baidu.com&quot;</span> /&gt;</span><br><br><span class="hljs-comment">&lt;!-- 在AndroidManifest.xml中声明该style--&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">application</span> <span class="hljs-attr">android:theme</span>=<span class="hljs-string">&quot;@style/textViewStyle&quot;</span> &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">application</span>&gt;</span><br><br><br><br></code></pre></td></tr></table></figure>



<h4 id="8-2：布局"><a href="#8-2：布局" class="headerlink" title="8.2：布局"></a>8.2：布局</h4><h5 id="8-2-1：LinearLayout线性布局"><a href="#8-2-1：LinearLayout线性布局" class="headerlink" title="8.2.1：LinearLayout线性布局"></a>8.2.1：LinearLayout线性布局</h5><p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/15116314.jpg"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/15116314.jpg" srcset="/img/loading.gif" lazyload alt="img"></a></p>
<p> weight计算</p>
<p> 组件使用<strong>wrap_content</strong>直接按照比例计算</p>
<p> 组件使用<strong>fill_parent</strong>时</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">根据 <span class="hljs-number">1</span> - <span class="hljs-number">2</span>*（所占比列）计算，如 <span class="hljs-number">1</span>：<span class="hljs-number">2</span>：<span class="hljs-number">3</span>，则第一个组件所占比列为 <span class="hljs-number">1</span> - <span class="hljs-number">2</span>*(<span class="hljs-number">1</span><span class="hljs-regexp">/(1+2+3)) = 2/</span><span class="hljs-number">3</span><br><br></code></pre></td></tr></table></figure>

<p> 分割线</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs XML"><span class="hljs-comment">&lt;!-- 使用如下代码可以在组件之间添加分割线</span><br><span class="hljs-comment">&lt;View</span><br><span class="hljs-comment">      android:layout_width=&quot;match_parent&quot;</span><br><span class="hljs-comment">      android:layout_height=&quot;1px&quot;</span><br><span class="hljs-comment">      android:background=&quot;#000000&quot; /&gt;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"></span><br></code></pre></td></tr></table></figure>

<h5 id="8-2-2：RelativeLayout相对布局"><a href="#8-2-2：RelativeLayout相对布局" class="headerlink" title="8.2.2：RelativeLayout相对布局"></a>8.2.2：RelativeLayout相对布局</h5><p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/797932661-1.png"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/797932661-1.png" srcset="/img/loading.gif" lazyload alt="img"></a></p>
<h5 id="8-2-3：TableLayout表格布局"><a href="#8-2-3：TableLayout表格布局" class="headerlink" title="8.2.3：TableLayout表格布局"></a>8.2.3：TableLayout表格布局</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs XML">//确定行列数<br>①如果我们直接往TableLayout中添加组件的话,那么这个组件将占满一行！！！<br>②如果我们想一行上有多个组件的话,就要添加一个TableRow的容器,把组件都丢到里面！<br>③tablerow中的组件个数就决定了该行有多少列,而列的宽度由该列中最宽的单元格决定<br>④tablerow的layout_width属性,默认是fill_parent的,我们自己设置成其他的值也不会生效！！！ 但是layout_height默认是wrapten——content的,我们却可以自己设置大小！<br>⑤整个表格布局的宽度取决于父容器的宽度(占满父容器本身)<br>⑥有多少行就要自己数啦,一个tablerow一行,一个单独的组件也一行！多少列则是看tableRow中 的组件个数,组件最多的就是TableLayout的列数<br><br><br>//常用属性<br>android:collapseColumns:设置需要被隐藏的列的序号<br>android:shrinkColumns:设置允许被收缩的列的列序号<br>android:stretchColumns:设置运行被拉伸的列的列序号<br><br>以上这三个属性的列号都是从0开始算的,比如shrinkColunmns = &quot;2&quot;,对应的是第三列！<br>可以设置多个,用逗号隔开比如&quot;0,2&quot;,如果是所有列都生效,则用&quot;*&quot;号即可<br>除了这三个常用属性,还有两个属性,分别就是跳格子以及合并单元格,这和HTML中的Table类似:<br><br>android:layout_column=&quot;2&quot;:表示的就是跳过第二个,直接显示到第三个格子处,从1开始算的!<br>android:layout_span=&quot;4&quot;:表示合并4个单元格,也就说这个组件占4个单元格<br><br>JAVA<br><span class="hljs-tag">&lt;<span class="hljs-name">TableLayout</span>  </span><br><span class="hljs-tag">    <span class="hljs-attr">android:id</span>=<span class="hljs-string">&quot;@+id/TableLayout2&quot;</span>  </span><br><span class="hljs-tag">    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;fill_parent&quot;</span>  </span><br><span class="hljs-tag">    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;wrap_content&quot;</span>  </span><br><span class="hljs-tag">    <span class="hljs-attr">android:collapseColumns</span>=<span class="hljs-string">&quot;0,2&quot;</span> &gt;</span>  <br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">TableRow</span>&gt;</span>  <br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>  </span><br><span class="hljs-tag">            <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;wrap_content&quot;</span>  </span><br><span class="hljs-tag">            <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;wrap_content&quot;</span>  </span><br><span class="hljs-tag">            <span class="hljs-attr">android:text</span>=<span class="hljs-string">&quot;one&quot;</span> /&gt;</span>  <br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>  </span><br><span class="hljs-tag">            <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;wrap_content&quot;</span>  </span><br><span class="hljs-tag">            <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;wrap_content&quot;</span>  </span><br><span class="hljs-tag">            <span class="hljs-attr">android:text</span>=<span class="hljs-string">&quot;two&quot;</span> /&gt;</span>  <br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>  </span><br><span class="hljs-tag">            <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;wrap_content&quot;</span>  </span><br><span class="hljs-tag">            <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;wrap_content&quot;</span>  </span><br><span class="hljs-tag">            <span class="hljs-attr">android:text</span>=<span class="hljs-string">&quot;three&quot;</span> /&gt;</span>  <br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>  </span><br><span class="hljs-tag">            <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;wrap_content&quot;</span>  </span><br><span class="hljs-tag">            <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;wrap_content&quot;</span>  </span><br><span class="hljs-tag">            <span class="hljs-attr">android:text</span>=<span class="hljs-string">&quot;four&quot;</span> /&gt;</span>  <br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>  </span><br><span class="hljs-tag">            <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;wrap_content&quot;</span>  </span><br><span class="hljs-tag">            <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;wrap_content&quot;</span>  </span><br><span class="hljs-tag">            <span class="hljs-attr">android:text</span>=<span class="hljs-string">&quot;five&quot;</span> /&gt;</span>  <br>    <span class="hljs-tag">&lt;/<span class="hljs-name">TableRow</span>&gt;</span>  <br><span class="hljs-tag">&lt;/<span class="hljs-name">TableLayout</span>&gt;</span><br><br></code></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/Snipaste_2023-07-12_16-02-59.png"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/Snipaste_2023-07-12_16-02-59.png" srcset="/img/loading.gif" lazyload alt="Snipaste_2023-07-12_16-02-59"></a></p>
<p>Snipaste_2023-07-12_16-02-59</p>
<h5 id="8-2-4：FrameLayout帧布局"><a href="#8-2-4：FrameLayout帧布局" class="headerlink" title="8.2.4：FrameLayout帧布局"></a>8.2.4：FrameLayout帧布局</h5><p> <strong>直接在屏幕上开辟出一块空白的区域,当我们往里面添加控件的时候,会默认把他们放到这块区域的左上角,而这种布局方式却没有任何的定位方式,所以它应用的场景并不多;帧布局的大小由控件中最大的子控件决定,如果控件的大小一样大的话,那么同一时刻就只能看到最上面的那个组件</strong>!后续添加的控件会覆盖前一个!虽然默认会将控件放置在左上角,但是我们也可以通过layout_gravity属性,指定到其他的位置</p>
<h5 id="8-2-5：GridLayout网格布局"><a href="#8-2-5：GridLayout网格布局" class="headerlink" title="8.2.5：GridLayout网格布局"></a>8.2.5：GridLayout网格布局</h5><p> 与TableLayout类似。相比其多了许多功能，如下</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs">1.可以自己设置布局中组件的排列方式<br>2.可以自定义网格布局有多少行,多少列<br>3.可以直接设置组件位于某行某列<br>4.可以设置组件横跨几行或者几列<br><br></code></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/D07C612B-0DB8-4775-8045-9318F73C0B13.jpeg"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/D07C612B-0DB8-4775-8045-9318F73C0B13.jpeg" srcset="/img/loading.gif" lazyload alt="img"></a></p>
<h5 id="8-2-6：AbsoluteLayout绝对布局"><a href="#8-2-6：AbsoluteLayout绝对布局" class="headerlink" title="8.2.6：AbsoluteLayout绝对布局"></a>8.2.6：AbsoluteLayout绝对布局</h5><p> 不建议使用，其是通过坐标的方式定位位置的，在不同尺寸的屏幕上都会导致出现组件撕裂的状况</p>
<h4 id="8-3：res应用资源"><a href="#8-3：res应用资源" class="headerlink" title="8.3：res应用资源"></a>8.3：res应用资源</h4><p>​	</p>
<table>
<thead>
<tr>
<th>animator&#x2F;</th>
<th>用于定义属性动画的 XML 文件</th>
</tr>
</thead>
<tbody><tr>
<td>anim&#x2F;</td>
<td>用于定义渐变动画的 XML 文件</td>
</tr>
<tr>
<td>color&#x2F;</td>
<td>用于定义颜色状态列表的 XML 文件</td>
</tr>
<tr>
<td>drawable&#x2F;</td>
<td>位图文件（.png、.9.png、.jpg、.gif）或编译为以下可绘制对象资源子类型的 XML 文件： 位图文件、九宫格（可调整大小的位图）、状态列表、形状、动画可绘制对象、其他可绘制对象</td>
</tr>
<tr>
<td>mipmap&#x2F;</td>
<td>适用于不同启动器图标密度的可绘制对象文件。应用图标放这里。mipmap后面跟着的dpi类别，比如<code>hdpi</code> <code>mdpi</code>，里面的图标尺寸大小是不同的。可以参考默认图标的大小，来切App的图标。如果要省事，可以用一个图标复制进各个目录中</td>
</tr>
<tr>
<td>layout&#x2F;</td>
<td>用于定义用户界面布局的 XML 文件。放layout文件。</td>
</tr>
<tr>
<td>menu&#x2F;</td>
<td>用于定义应用菜单（如选项菜单、上下文菜单或子菜单）的 XML 文件。</td>
</tr>
<tr>
<td>values&#x2F;</td>
<td>包含字符串、整型数和颜色等简单值的 XML 文件</td>
</tr>
<tr>
<td>raw&#x2F;</td>
<td>需以原始形式保存的任意文件</td>
</tr>
<tr>
<td>xml&#x2F;</td>
<td>可在运行时通过调用 Resources.getXML() 读取的任意 XML 文件。各种 XML 配置文件（如可搜索配置）都必须保存在此处</td>
</tr>
<tr>
<td>font&#x2F;</td>
<td>带有扩展名的字体文件（如 .ttf、.otf 或 .ttc），或包含 元素的 XML 文件</td>
</tr>
</tbody></table>
<h4 id="8-4：MeasureSpec"><a href="#8-4：MeasureSpec" class="headerlink" title="8.4：MeasureSpec"></a>8.4：MeasureSpec</h4><p>​	父View通过MeasureSpec给子View传送尺寸的要求，MeasureSpec包含尺寸和模式(3种模式)</p>
<p>​	<strong>1: unspecified(未指定)</strong></p>
<p>父控件对子控件不加任何束缚，子元素可以得到任意想要的大小，这种MeasureSpec一般是由父控件自身的特性决定的。比如ScrollView，它的子View可以随意设置大小，无论多高，都能滚动显示，这个时候，size一般就没什么意义</p>
<p>​	<strong>2：exactly(完全)</strong></p>
<p>父控件为子View指定确切大小，希望子View完全按照自己给定尺寸来处理，这时的MeasureSpec一般是父控件根据自身的MeasureSpec跟子View的布局参数来确定的。一般这种情况下size&gt;0,有个确定值。</p>
<p>​	<strong>3：at_most(至多)</strong></p>
<p>父控件为子元素指定最大参考尺寸，希望子View的尺寸不要超过这个尺寸，这种模式也是父控件根据自身的MeasureSpec跟子View的布局参数来确定的，一般是子View的布局参数采用wrap_content的时候</p>
<h4 id="8-5：View的post方法"><a href="#8-5：View的post方法" class="headerlink" title="8.5：View的post方法"></a>8.5：View的post方法</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">post</span><span class="hljs-params">(Runnable action)</span> &#123;<br>    <span class="hljs-keyword">final</span> <span class="hljs-type">AttachInfo</span> <span class="hljs-variable">attachInfo</span> <span class="hljs-operator">=</span> mAttachInfo;<br>    <span class="hljs-keyword">if</span> (attachInfo != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-comment">//这个方法是将一个Runnable加到消息队列中，并且会在这个		//handler关联的线程里执行</span><br>        <span class="hljs-keyword">return</span> attachInfo.mHandler.post(action);<br>    &#125;<br><br>    getRunQueue().post(action);<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><br><span class="hljs-keyword">private</span> HandlerActionQueue <span class="hljs-title function_">getRunQueue</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">if</span> (mRunQueue == <span class="hljs-literal">null</span>) &#123;<br>        mRunQueue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HandlerActionQueue</span>();<br>    &#125;<br>    <span class="hljs-keyword">return</span> mRunQueue;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p><strong>1: AttachInfo</strong></p>
<p>​	是View的静态内部类，View关联到父window后，用这个类存储一些信息</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">WindowId mWindowId <span class="hljs-keyword">window</span>的标志<br><span class="hljs-keyword">View</span> mRootView 最顶部的<span class="hljs-keyword">view</span><br><span class="hljs-keyword">Handler</span> mHandler 这个<span class="hljs-keyword">handler</span>可以用来处理任务<br></code></pre></td></tr></table></figure>

<p><strong>2:HandlerActionQueue</strong></p>
<p>​	当View还没有handler的时候，拿HandlerActionQueue来缓存任务，HandlerAction是它的静态内部类，存储Runnable与延时信息</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HandlerActionQueue</span> &#123;<br>    <span class="hljs-keyword">private</span> HandlerAction[] mActions;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">post</span><span class="hljs-params">(Runnable action)</span>&#123;<span class="hljs-comment">//...&#125;</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">executeActions</span><span class="hljs-params">(Handler handler)</span>&#123;<span class="hljs-comment">//...&#125;</span><br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HandlerAction</span> &#123;<br>        <span class="hljs-keyword">final</span> Runnable action;<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> delay;<br>        <span class="hljs-comment">// ...</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>3:处理任务</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">void</span> <span class="hljs-title function_">dispatchAttachedToWindow</span><span class="hljs-params">(AttachInfo info, <span class="hljs-type">int</span> visibility)</span> &#123;<br>    <br>    <span class="hljs-keyword">if</span> (mRunQueue != <span class="hljs-literal">null</span>) &#123;<br>        mRunQueue.executeActions(info.mHandler);<br>        mRunQueue = <span class="hljs-literal">null</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>总结：</strong></p>
<p><strong>View</strong>的post方法，实际上是使用了<strong>AttachInfo</strong>的<code>handler</code>。</p>
<p>如果<strong>View</strong>当前还没有<strong>AttachInfo</strong>，则把任务添加到了<strong>View</strong>自己的<strong>HandlerActionQueue</strong>队列中，然后在<code>dispatchAttachedToWindow</code>中把任务交给传入的<strong>AttachInfo</strong>的<code>handler</code>。也可以这样认为，**<code>View.post</code>用的就是<code>handler.post</code>**</p>
<p>我们在获取View的宽高时，会利用View的post方法，就是等View真的关联到window再拿宽高信息</p>
<p><img src="E:\bolg\source_posts\android笔记.assets\Snipaste_2023-08-07_15-23-53.png" srcset="/img/loading.gif" lazyload alt="Snipaste_2023-08-07_15-23-53"></p>
<h4 id="8-6-自定义View"><a href="#8-6-自定义View" class="headerlink" title="8.6: 自定义View"></a>8.6: 自定义View</h4><p>​			<strong>自定义Toast</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs xml">//布局xml文件<br><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span> <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;match_parent&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;match_parent&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:background</span>=<span class="hljs-string">&quot;@drawable/bg_my_toast&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:orientation</span>=<span class="hljs-string">&quot;vertical&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">TextView</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:id</span>=<span class="hljs-string">&quot;@+id/tv1&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;wrap_content&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;wrap_content&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:layout_gravity</span>=<span class="hljs-string">&quot;center&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:layout_margin</span>=<span class="hljs-string">&quot;12dp&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:gravity</span>=<span class="hljs-string">&quot;center&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:minWidth</span>=<span class="hljs-string">&quot;120dp&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:text</span>=<span class="hljs-string">&quot;Warning&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:textColor</span>=<span class="hljs-string">&quot;#C2185B&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:textSize</span>=<span class="hljs-string">&quot;18sp&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span><br><br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.example.customer_view;<br><br><span class="hljs-keyword">import</span> androidx.appcompat.app.AppCompatActivity;<br><br><span class="hljs-keyword">import</span> android.content.Context;<br><span class="hljs-keyword">import</span> android.os.Bundle;<br><span class="hljs-keyword">import</span> android.view.Gravity;<br><span class="hljs-keyword">import</span> android.view.LayoutInflater;<br><span class="hljs-keyword">import</span> android.view.View;<br><span class="hljs-keyword">import</span> android.widget.TextView;<br><span class="hljs-keyword">import</span> android.widget.Toast;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> &#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);<br>        setContentView(R.layout.mine_layout);<br>        myToast(getApplicationContext(),<span class="hljs-string">&quot;hello world&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">myToast</span><span class="hljs-params">(Context context, String msg)</span> &#123;<br>        <span class="hljs-type">View</span> <span class="hljs-variable">view</span> <span class="hljs-operator">=</span> LayoutInflater.from(context).inflate(R.layout.mine_layout, <span class="hljs-literal">null</span>);<br>        <span class="hljs-type">TextView</span> <span class="hljs-variable">tv1</span> <span class="hljs-operator">=</span> view.findViewById(R.id.tv1);<br>        tv1.setText(msg);<br>        <span class="hljs-type">Toast</span> <span class="hljs-variable">toast</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Toast</span>(context);<br>        toast.setGravity(Gravity.BOTTOM | Gravity.CENTER, <span class="hljs-number">0</span>, <span class="hljs-number">440</span>);<br>        toast.setDuration(Toast.LENGTH_SHORT);<br>        toast.setView(view);<br>        toast.show();<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="E:\bolg\source_posts\android笔记.assets\Snipaste_2023-08-08_15-23-25.png" srcset="/img/loading.gif" lazyload alt="Snipaste_2023-08-08_15-23-25"></p>
<h4 id="8-7：动画"><a href="#8-7：动画" class="headerlink" title="8.7：动画"></a>8.7：动画</h4><p>​		1： 帧动画：使用一系列的图片按顺序播放，使用AnimationDrawable实现帧动画的效果</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- 帧动画列表(图片自备) --&gt;</span><br><br><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">animation-list</span> <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:id</span>=<span class="hljs-string">&quot;@+id/icon_pic&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:oneshot</span>=<span class="hljs-string">&quot;false&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">item</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:drawable</span>=<span class="hljs-string">&quot;@drawable/up&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:duration</span>=<span class="hljs-string">&quot;250&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">item</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:drawable</span>=<span class="hljs-string">&quot;@drawable/left&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:duration</span>=<span class="hljs-string">&quot;250&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">item</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:drawable</span>=<span class="hljs-string">&quot;@drawable/down&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:duration</span>=<span class="hljs-string">&quot;250&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">item</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:drawable</span>=<span class="hljs-string">&quot;@drawable/right&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:duration</span>=<span class="hljs-string">&quot;250&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">animation-list</span>&gt;</span><br></code></pre></td></tr></table></figure>



<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- 布局xml文件 --&gt;</span><br><br><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span> <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:orientation</span>=<span class="hljs-string">&quot;vertical&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;match_parent&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;match_parent&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">ImageView</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:id</span>=<span class="hljs-string">&quot;@+id/icon&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;100dp&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;100dp&quot;</span>/&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;match_parent&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;wrap_content&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:orientation</span>=<span class="hljs-string">&quot;horizontal&quot;</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">Button</span></span><br><span class="hljs-tag">            <span class="hljs-attr">android:id</span>=<span class="hljs-string">&quot;@+id/start&quot;</span></span><br><span class="hljs-tag">            <span class="hljs-attr">android:text</span>=<span class="hljs-string">&quot;开始&quot;</span></span><br><span class="hljs-tag">            <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;100dp&quot;</span></span><br><span class="hljs-tag">            <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;50dp&quot;</span>/&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">Button</span></span><br><span class="hljs-tag">            <span class="hljs-attr">android:id</span>=<span class="hljs-string">&quot;@+id/stop&quot;</span></span><br><span class="hljs-tag">            <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;100dp&quot;</span></span><br><span class="hljs-tag">            <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;50dp&quot;</span></span><br><span class="hljs-tag">            <span class="hljs-attr">android:text</span>=<span class="hljs-string">&quot;停止&quot;</span> /&gt;</span><br><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//activity代码</span><br><br><span class="hljs-keyword">private</span> AnimationDrawable ani;<br><br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);<br>        setContentView(R.layout.activity_main);<br><br>        <span class="hljs-type">ImageView</span> <span class="hljs-variable">imageView</span> <span class="hljs-operator">=</span> findViewById(R.id.icon);<br>        imageView.setBackgroundResource(R.drawable.ani_frame);<br>        ani = (AnimationDrawable) imageView.getBackground();<br>        findViewById(R.id.start).setOnClickListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">View</span>.OnClickListener() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onClick</span><span class="hljs-params">(View view)</span> &#123;<br>                ani.start();<br>            &#125;<br>        &#125;);<br><br>        findViewById(R.id.stop).setOnClickListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">View</span>.OnClickListener() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onClick</span><span class="hljs-params">(View view)</span> &#123;<br>                ani.stop();<br>            &#125;<br>        &#125;);<br>    &#125;<br></code></pre></td></tr></table></figure>

<p><img src="E:\bolg\source_posts\android笔记.assets\Snipaste_2023-08-08_16-34-18.png" srcset="/img/loading.gif" lazyload alt="Snipaste_2023-08-08_16-34-18"></p>
<p>​		2: 补间动画：通过使用Animation对单张图片执行一系列的转换来创建动画，文件一般放在res&#x2F;anim中</p>
<h3 id="9：事件处理机制"><a href="#9：事件处理机制" class="headerlink" title="9：事件处理机制"></a>9：事件处理机制</h3><h4 id="9-1：基于监听"><a href="#9-1：基于监听" class="headerlink" title="9.1：基于监听"></a>9.1：基于监听</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//匿名内部类的方式</span><br>findViewById(R.id.custom).setOnClickListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">View</span>.OnClickListener() &#123;<br>    <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onClick</span><span class="hljs-params">(View view)</span> &#123;<br>				...<br>        <br>&#125;);<br></code></pre></td></tr></table></figure>



<h4 id="9-2：基于回调"><a href="#9-2：基于回调" class="headerlink" title="9.2：基于回调"></a>9.2：基于回调</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> &#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);<br>        setContentView(R.layout.activity_main);<br><br>        findViewById(R.id.custom).setOnKeyListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">View</span>.OnKeyListener() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">onKey</span><span class="hljs-params">(View view, <span class="hljs-type">int</span> i, KeyEvent keyEvent)</span> &#123;<br>                System.out.println(<span class="hljs-string">&quot;view.onKeyDownz&quot;</span>);<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br>        &#125;);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">onKeyDown</span><span class="hljs-params">(<span class="hljs-type">int</span> keyCode, KeyEvent event)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;activity.onKey&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.onKeyDown(keyCode, event);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//回调方法返回值为false时，会继续往上传播，view --&gt; activity 直到返回true终止</span><br><br><br></code></pre></td></tr></table></figure>



<h4 id="9-3：Handler消息传递机制"><a href="#9-3：Handler消息传递机制" class="headerlink" title="9.3：Handler消息传递机制"></a>9.3：Handler消息传递机制</h4><p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/90456225.jpg"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/90456225.jpg" srcset="/img/loading.gif" lazyload alt="img"></a></p>
<p> 安卓规定UI组件只能在自己的线程中进行操作，避免多线程操作UI组件的并发问题，使得其他线程想操作其他线程中的UI组件时无能为力，直到Handler出现</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">UI线程:就是我们的主线程,系统在创建UI线程的时候会初始化一个Looper对象,同时也会创建一个与其关联的MessageQueue;</span><br><br><span class="hljs-section">Handler:作用就是发送与处理信息,如果希望Handler正常工作,在当前线程中要有一个Looper对象</span><br><br><span class="hljs-section">Message:Handler接收与处理的消息对象</span><br><br><span class="hljs-section">MessageQueue:消息队列,先进先出管理Message,在初始化Looper对象时会创建一个与之关联的MessageQueue;</span><br><br><span class="hljs-section">Looper:每个线程只能够有一个Looper,管理MessageQueue,不断地从中取出Message分发给对应的Handler处理</span><br><br></code></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/25345060.jpg"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/25345060.jpg" srcset="/img/loading.gif" lazyload alt="img"></a></p>
<p> 简而言之就是，当我们的子线程想要修改activity中的ui组件时，可以通过Handler对象发送一个Message到activity线程中的MessageQueue中等待，由其中的Looper取出Message并分发给Handler处理</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs Text">void handleMessage(Message msg):处理消息的方法,通常是用于被重写<br><br>sendEmptyMessage(int what):发送空消息<br><br>sendEmptyMessageDelayed(int what,long delayMillis):指定延时多少毫秒后发送空信息<br><br>sendMessage(Message msg):立即发送信息<br><br>sendMessageDelayed(Message msg):指定延时多少毫秒后发送信息<br><br>final boolean hasMessage(int what):检查消息队列中是否包含what属性为指定值的消息 如果是参数为(int what,Object object):除了判断what属性,还需要判断Object属性是否为指定对象的消息<br><br></code></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-comment">//在主线程中使用Handler</span><br><span class="hljs-comment">//主线程中，已经初始化了Looper对象，直接实例化Handler即可使用</span><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">WHAT</span> <span class="hljs-operator">=</span> <span class="hljs-number">11</span>;<br><br>    <span class="hljs-keyword">private</span> EditText text;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Handler</span> <span class="hljs-variable">handler</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Handler</span>()&#123;<br>        <span class="hljs-meta">@SuppressLint(&quot;HandlerLeak&quot;)</span><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleMessage</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> Message msg)</span> &#123;<br>            List&lt;Integer&gt; list =  <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>            <span class="hljs-keyword">if</span>(WHAT == msg.what)&#123;<br>                <span class="hljs-type">int</span> <span class="hljs-variable">upper</span> <span class="hljs-operator">=</span> msg.getData().getInt(<span class="hljs-string">&quot;upper&quot;</span>);<br>                outer:<br>                <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span>; i &lt;= upper; i++)&#123;<br>                    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span>; j &lt;= Math.sqrt(i); j++)&#123;<br>                        <span class="hljs-keyword">if</span>(i % j == <span class="hljs-number">0</span>)&#123;<br>                            <span class="hljs-keyword">continue</span> outer;<br>                        &#125;<br>                    &#125;<br>                    list.add(i);<br>                &#125;<br>            &#125;<br><br>            System.out.println(list.toString());<br>        &#125;<br>    &#125;;<br><br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);<br>        setContentView(R.layout.activity_main);<br>        text = findViewById(R.id.etNum);<br><br>        findViewById(R.id.btn).setOnClickListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">View</span>.OnClickListener() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onClick</span><span class="hljs-params">(View view)</span> &#123;<br>                cal(view);<br>            &#125;<br>        &#125;);<br><br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">cal</span><span class="hljs-params">(View view)</span>&#123;<br>        <span class="hljs-type">Message</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Message</span>();<br>        message.what = WHAT;<br><br>        <span class="hljs-type">Bundle</span> <span class="hljs-variable">bundle</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Bundle</span>();<br>        bundle.putInt(<span class="hljs-string">&quot;upper&quot;</span>,Integer.parseInt(text.getText().toString()));<br><br>        message.setData(bundle);<br>        handler.sendMessage(message);<br>    &#125;<br>&#125;<br><br>JAVA<br><span class="hljs-comment">//在子线程中使用handler</span><br><span class="hljs-comment">//子线程中需要自己实例化Looper</span><br><br><span class="hljs-comment">//子线程</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyThread</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Thread</span>&#123;<br><br>    <span class="hljs-keyword">public</span> Handler handler;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> List&lt;Integer&gt; list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>        Looper.prepare();<br>        handler = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Handler</span>() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleMessage</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> Message msg)</span> &#123;<br>                <span class="hljs-keyword">if</span>(msg.what == <span class="hljs-number">11</span>)&#123;<br>                    <span class="hljs-type">int</span> <span class="hljs-variable">upper</span> <span class="hljs-operator">=</span> msg.getData().getInt(<span class="hljs-string">&quot;upper&quot;</span>);<br>                    outer:<br>                    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span>; j &lt;= upper; j++)&#123;<br>                        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span>; i &lt;= Math.sqrt(j); i++)&#123;<br>                            <span class="hljs-keyword">if</span>(j % i == <span class="hljs-number">0</span>)&#123;<br>                                <span class="hljs-keyword">continue</span> outer;<br>                            &#125;<br>                        &#125;<br>                        list.add(j);<br>                    &#125;<br>                    System.out.println(Thread.currentThread().getName());<br>                    System.out.println(list.toString());<br>                &#125;<br>            &#125;<br>        &#125;;<br><br>        Looper.loop();<br>    &#125;<br>&#125;<br><br><br><span class="hljs-comment">//主线程</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">WHAT</span> <span class="hljs-operator">=</span> <span class="hljs-number">11</span>;<br><br>    <span class="hljs-keyword">private</span> MyThread thread;<br><br>    <span class="hljs-keyword">private</span> EditText text;<br><br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);<br>        setContentView(R.layout.activity_main);<br>        text = findViewById(R.id.etNum);<br><br>        thread = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyThread</span>();<br>        thread.start();<br>        findViewById(R.id.btn).setOnClickListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">View</span>.OnClickListener() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onClick</span><span class="hljs-params">(View view)</span> &#123;<br>                cal(view);<br>            &#125;<br>        &#125;);<br><br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">cal</span><span class="hljs-params">(View view)</span>&#123;<br>        <span class="hljs-type">Message</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Message</span>();<br>        message.what = WHAT;<br><br>        <span class="hljs-type">Bundle</span> <span class="hljs-variable">bundle</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Bundle</span>();<br>        bundle.putInt(<span class="hljs-string">&quot;upper&quot;</span>,Integer.parseInt(text.getText().toString()));<br><br>        message.setData(bundle);<br>        thread.handler.sendMessage(message);<br>        System.out.println(Thread.currentThread().getName());<br>    &#125;<br>&#125;<br><br><br></code></pre></td></tr></table></figure>



<h4 id="9-4：AsyncTask异步"><a href="#9-4：AsyncTask异步" class="headerlink" title="9.4：AsyncTask异步"></a>9.4：AsyncTask异步</h4><p> 与Handler类似用来处理异步任务，不过其使用线程池的方式，且代码量较少</p>
<figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs subunit">AsyncTask&lt;Params,progress,Result&gt;<br>Params: 启动任务入参<br><span class="hljs-keyword">progress: </span>后台执行任务的百分比<br>Result: 后台执行任务的返回结果<br><br></code></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/27686655.jpg"><img src="https://raw.githubusercontent.com/lier-ok/typora_pic/main/img/27686655.jpg" srcset="/img/loading.gif" lazyload alt="img"></a></p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">注意事项:<br><span class="hljs-number">1.</span>Task实例必须在UI线程中创建<br><span class="hljs-number">2.</span>execute方法必须在UI线程中调用<br><span class="hljs-number">3.</span>不要手动的调用on<span class="hljs-constructor">PreExecute()</span>. on<span class="hljs-constructor">PostExecute(Result)</span>. <span class="hljs-keyword">do</span><span class="hljs-constructor">InBackground(<span class="hljs-params">params</span><span class="hljs-operator">...</span>)</span>. on<span class="hljs-constructor">ProgressUpdate(Progress<span class="hljs-operator">...</span>)</span>这些方法<br><span class="hljs-number">4.</span>task只能执行一次，多次调用会出现异常<br></code></pre></td></tr></table></figure>

<p> <strong>以上Handler和AsyncTask实现异步的方案在安卓11已被废弃</strong>，可使用Executors替代</p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/android/">android</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/07/27/c++%E7%AC%94%E8%AE%B0/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">c++笔记</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/07/27/CICD/">
                        <span class="hidden-mobile">CICD</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <i class="iconfont icon-love"></i>lier 
  </div>
  

  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.0/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js" ></script>






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    (function () {
      var path = "/local-search.xml";
      $('#local-search-input').on('click', function() {
        searchFunc(path, 'local-search-input', 'local-search-result');
      });
      $('#modalSearch').on('shown.bs.modal', function() {
        $('#local-search-input').focus();
      });
    })()
  </script>















<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
